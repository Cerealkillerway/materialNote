!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a(window.jQuery)}(function(a){Array.prototype.reduce||(Array.prototype.reduce=function(a){var e,b=Object(this),c=b.length>>>0,d=0;if(2===arguments.length)e=arguments[1];else{for(;d<c&&!(d in b);)d++;if(d>=c)throw new TypeError("Reduce of empty array with no initial value");e=b[d++]}for(;d<c;d++)d in b&&(e=a(e,b[d],d,b));return e}),"function"!=typeof Array.prototype.filter&&(Array.prototype.filter=function(a){for(var b=Object(this),c=b.length>>>0,d=[],e=arguments.length>=2?arguments[1]:void 0,f=0;f<c;f++)if(f in b){var g=b[f];a.call(e,g,f,b)&&d.push(g)}return d});var C,b="function"==typeof define&&define.amd,c=function(b){if("Roboto"===b)return!0;var c="Comic Sans MS"===b?"Courier New":"Comic Sans MS",d=a("<div>").css({position:"absolute",left:"-9999px",top:"-9999px",fontSize:"200px"}).text("mmmmmmmmmwwwwwww").appendTo(document.body),e=d.css("fontFamily",c).width(),f=d.css("fontFamily",b+","+c).width();return d.remove(),e!==f},d=navigator.userAgent,e={isMac:navigator.appVersion.indexOf("Mac")>-1,isMSIE:/MSIE|Trident/i.test(d),isFF:/firefox/i.test(d),isWebkit:/webkit/i.test(d),isSafari:/safari/i.test(d),jqueryVersion:parseFloat(a.fn.jquery),isSupportAmd:b,hasCodeMirror:b?require.specified("CodeMirror"):!!window.CodeMirror,isFontInstalled:c,isW3CRangeSupport:!!document.createRange},f=function(){var b=function(a){return function(b){return a===b}},c=function(a,b){return a===b},d=function(a){return function(b,c){return b[a]===c[a]}},e=function(){return!0},f=function(){return!1},g=function(a){return function(){return!a.apply(a,arguments)}},h=function(a,b){return function(c){return a(c)&&b(c)}},j=0;return{eq:b,eq2:c,peq2:d,ok:e,fail:f,self:function(a){return a},not:g,and:h,uniqueId:function(a){var b=++j+"";return a?a+b:b},rect2bnd:function(b){var c=a(document);return{top:b.top+c.scrollTop(),left:b.left+c.scrollLeft(),width:b.right-b.left,height:b.bottom-b.top}},invertObject:function(a){var b={};for(var c in a)a.hasOwnProperty(c)&&(b[a[c]]=c);return b},namespaceToCamel:function(a,b){return(b=b||"")+a.split(".").map(function(a){return a.substring(0,1).toUpperCase()+a.substring(1)}).join("")}}}(),g=function(){var b=function(a){return a[0]},c=function(a){return a[a.length-1]},d=function(a){return a.slice(0,a.length-1)},e=function(a){return a.slice(1)},g=function(a,b){for(var c=0,d=a.length;c<d;c++){var e=a[c];if(b(e))return e}},h=function(a,b){for(var c=0,d=a.length;c<d;c++)if(!b(a[c]))return!1;return!0},i=function(b,c){return-1!==a.inArray(c,b)},j=function(a,b){return b=b||f.self,a.reduce(function(a,c){return a+b(c)},0)},k=function(a){for(var b=[],c=-1,d=a.length;++c<d;)b[c]=a[c];return b},l=function(a,d){return a.length?e(a).reduce(function(a,b){var e=c(a);return d(c(e),b)?e[e.length]=b:a[a.length]=[b],a},[[b(a)]]):[]},m=function(a){for(var b=[],c=0,d=a.length;c<d;c++)a[c]&&b.push(a[c]);return b},n=function(a){for(var b=[],c=0,d=a.length;c<d;c++)i(b,a[c])||b.push(a[c]);return b},o=function(a,b){var c=a.indexOf(b);return-1===c?null:a[c+1]};return{head:b,last:c,initial:d,tail:e,prev:function(a,b){var c=a.indexOf(b);return-1===c?null:a[c-1]},next:o,find:g,contains:i,all:h,sum:j,from:k,clusterBy:l,compact:m,unique:n}}(),h=String.fromCharCode(160),i="\ufeff",j=function(){var b=function(b){return b&&a(b).hasClass("note-editable")},c=function(b){return b&&a(b).hasClass("note-control-sizing")},d=function(b){var c;if(b.hasClass("note-air-editor")){var d=g.last(b.attr("id").split("-"));return c=function(b){return function(){return a(b+d)}},{editor:function(){return b},holder:function(){return b.data("holder")},editable:function(){return b},popover:c("#note-popover-"),handle:c("#note-handle-"),dialog:c("#note-dialog-")}}return c=function(a){return function(){return b.find(a)}},{editor:function(){return b},holder:function(){return b.data("holder")},dropzone:c(".note-dropzone"),toolbar:c(".note-toolbar"),editable:c(".note-editable"),codable:c(".note-codable"),statusbar:c(".note-statusbar"),popover:c(".note-popover"),handle:c(".note-handle"),dialog:c(".note-dialog")}},k=function(b){var c=a(b).closest(".note-editor, .note-air-editor, .note-air-layout");if(!c.length)return null;var e;return e=c.is(".note-editor, .note-air-editor")?c:a("#note-editor-"+g.last(c.attr("id").split("-"))),d(e)},l=function(a){return a=a.toUpperCase(),function(b){return b&&b.nodeName.toUpperCase()===a}},m=function(a){return a&&3===a.nodeType},n=function(a){return a&&/^BR|^IMG|^HR/.test(a.nodeName.toUpperCase())},o=function(a){return!b(a)&&(a&&/^DIV|^P|^LI|^H[1-7]/.test(a.nodeName.toUpperCase()))},p=l("LI"),q=function(a){return o(a)&&!p(a)},r=l("TABLE"),s=function(a){return!(w(a)||t(a)||o(a)||r(a)||v(a))},t=function(a){return a&&/^UL|^OL/.test(a.nodeName.toUpperCase())},u=function(a){return a&&/^TD|^TH/.test(a.nodeName.toUpperCase())},v=l("BLOCKQUOTE"),w=function(a){return u(a)||v(a)||b(a)},x=l("A"),y=function(a){return s(a)&&!!H(a,o)},z=function(a){return s(a)&&!H(a,o)},A=l("BODY"),B=function(a,b){return a.nextSibling===b||a.previousSibling===b},C=function(a,b){b=b||f.ok;var c=[];return a.previousSibling&&b(a.previousSibling)&&c.push(a.previousSibling),c.push(a),a.nextSibling&&b(a.nextSibling)&&c.push(a.nextSibling),c},D=e.isMSIE?"&nbsp;":"<br>",E=function(a){return m(a)?a.nodeValue.length:a.childNodes.length},F=function(a){var b=E(a);return 0===b||(!m(a)&&1===b&&a.innerHTML===D||!(!g.all(a.childNodes,m)||""!==a.innerHTML))},G=function(a){n(a)||E(a)||(a.innerHTML=D)},H=function(a,c){for(;a;){if(c(a))return a;if(b(a))break;a=a.parentNode}return null},I=function(a,c){for(a=a.parentNode;a&&1===E(a);){if(c(a))return a;if(b(a))break;a=a.parentNode}return null},J=function(a,c){c=c||f.fail;var d=[];return H(a,function(a){return b(a)||d.push(a),c(a)}),d},K=function(a,b){var c=J(a);return g.last(c.filter(b))},L=function(b,c){for(var d=J(b),e=c;e;e=e.parentNode)if(a.inArray(e,d)>-1)return e;return null},M=function(a,b){b=b||f.fail;for(var c=[];a&&!b(a);)c.push(a),a=a.previousSibling;return c},N=function(a,b){b=b||f.fail;for(var c=[];a&&!b(a);)c.push(a),a=a.nextSibling;return c},O=function(a,b){var c=[];return b=b||f.ok,function d(e){a!==e&&b(e)&&c.push(e);for(var f=0,g=e.childNodes.length;f<g;f++)d(e.childNodes[f])}(a),c},P=function(b,c){var d=b.parentNode,e=a("<"+c+">")[0];return d.insertBefore(e,b),e.appendChild(b),e},Q=function(a,b){var c=b.nextSibling,d=b.parentNode;return c?d.insertBefore(a,c):d.appendChild(a),a},R=function(b,c){return a.each(c,function(a,c){b.appendChild(c)}),b},S=function(a){return 0===a.offset},T=function(a){return a.offset===E(a.node)},U=function(a){return S(a)||T(a)},V=function(a,b){for(;a&&a!==b;){if(0!==X(a))return!1;a=a.parentNode}return!0},W=function(a,b){for(;a&&a!==b;){if(X(a)!==E(a.parentNode)-1)return!1;a=a.parentNode}return!0},X=function(a){for(var b=0;a=a.previousSibling;)b+=1;return b},Y=function(a){return!!(a&&a.childNodes&&a.childNodes.length)},Z=function(a,c){var d,e;if(0===a.offset){if(b(a.node))return null;d=a.node.parentNode,e=X(a.node)}else Y(a.node)?(d=a.node.childNodes[a.offset-1],e=E(d)):(d=a.node,e=c?0:a.offset-1);return{node:d,offset:e}},$=function(a,c){var d,e;if(E(a.node)===a.offset){if(b(a.node))return null;d=a.node.parentNode,e=X(a.node)+1}else Y(a.node)?(d=a.node.childNodes[a.offset],e=0):(d=a.node,e=c?E(a.node):a.offset+1);return{node:d,offset:e}},_=function(a,b){return a.node===b.node&&a.offset===b.offset},aa=function(a){if(m(a.node)||!Y(a.node)||F(a.node))return!0;var b=a.node.childNodes[a.offset-1],c=a.node.childNodes[a.offset];return!(b&&!n(b)||c&&!n(c))},ba=function(a,b){for(;a;){if(b(a))return a;a=Z(a)}return null},ca=function(a,b){for(;a;){if(b(a))return a;a=$(a)}return null},da=function(a){if(!m(a.node))return!1;var b=a.node.nodeValue.charAt(a.offset-1);return b&&" "!==b&&b!==h},ea=function(a,b,c,d){for(var e=a;e&&(c(e),!_(e,b));){var f=d&&a.node!==e.node&&b.node!==e.node;e=$(e,f)}},fa=function(b,c){var d=J(c,f.eq(b));return a.map(d,X).reverse()},ga=function(a,b){for(var c=a,d=0,e=b.length;d<e;d++)c=c.childNodes.length<=b[d]?c.childNodes[c.childNodes.length-1]:c.childNodes[b[d]];return c},ha=function(a,b){var c=b&&b.isSkipPaddingBlankHTML,d=b&&b.isNotSplitEdgePoint;if(U(a)&&(m(a.node)||d)){if(S(a))return a.node;if(T(a))return a.node.nextSibling}if(m(a.node))return a.node.splitText(a.offset);var e=a.node.childNodes[a.offset],f=Q(a.node.cloneNode(!1),a.node);return R(f,N(e)),c||(G(a.node),G(f)),f},ia=function(a,b,c){var d=J(b.node,f.eq(a));return d.length?1===d.length?ha(b,c):d.reduce(function(a,d){return a===b.node&&(a=ha(b,c)),ha({node:d,offset:a?j.position(a):E(d)},c)}):null},ja=function(a,b){var f,h,c=b?o:w,d=J(a.node,c),e=g.last(d)||a.node;c(e)?(f=d[d.length-2],h=e):(f=e,h=f.parentNode);var i=f&&ia(f,a,{isSkipPaddingBlankHTML:b,isNotSplitEdgePoint:b});return i||h!==a.node||(i=a.node.childNodes[a.offset]),{rightNode:i,container:h}},ka=function(a){return document.createElement(a)},la=function(a){return document.createTextNode(a)},ma=function(a,b){if(a&&a.parentNode){if(a.removeNode)return a.removeNode(b);var c=a.parentNode;if(!b){var e,f,d=[];for(e=0,f=a.childNodes.length;e<f;e++)d.push(a.childNodes[e]);for(e=0,f=d.length;e<f;e++)c.insertBefore(d[e],a)}c.removeChild(a)}},na=function(a,c){for(;a&&!b(a)&&c(a);){var d=a.parentNode;ma(a),a=d}},oa=function(a,b){if(a.nodeName.toUpperCase()===b.toUpperCase())return a;var c=ka(b);return a.style.cssText&&(c.style.cssText=a.style.cssText),R(c,g.from(a.childNodes)),Q(c,a),ma(a),c},pa=l("TEXTAREA"),qa=function(a,b){var c=pa(a[0])?a.val():a.html();return b?c.replace(/[\n\r]/g,""):c},ra=function(b,c){var d=qa(b);if(c){var e=/<(\/?)(\b(?!!)[^>\s]*)(.*?)(\s*\/?>)/g;d=d.replace(e,function(a,b,c){c=c.toUpperCase();var d=/^DIV|^TD|^TH|^P|^LI|^H[1-7]/.test(c)&&!!b,e=/^BLOCKQUOTE|^TABLE|^TBODY|^TR|^HR|^UL|^OL/.test(c);return a+(d||e?"\n":"")}),d=a.trim(d)}return d};return{NBSP_CHAR:h,ZERO_WIDTH_NBSP_CHAR:i,blank:D,emptyPara:"<p>"+D+"</p>",makePredByNodeName:l,isEditable:b,isControlSizing:c,buildLayoutInfo:d,makeLayoutInfo:k,isText:m,isVoid:n,isPara:o,isPurePara:q,isInline:s,isBlock:f.not(s),isBodyInline:z,isBody:A,isParaInline:y,isList:t,isTable:r,isCell:u,isBlockquote:v,isBodyContainer:w,isAnchor:x,isDiv:l("DIV"),isLi:p,isBR:l("BR"),isSpan:l("SPAN"),isB:l("B"),isU:l("U"),isS:l("S"),isI:l("I"),isImg:l("IMG"),isTextarea:pa,isEmpty:F,isEmptyAnchor:f.and(x,F),isClosestSibling:B,withClosestSiblings:C,nodeLength:E,isLeftEdgePoint:S,isRightEdgePoint:T,isEdgePoint:U,isLeftEdgeOf:V,isRightEdgeOf:W,prevPoint:Z,nextPoint:$,isSamePoint:_,isVisiblePoint:aa,prevPointUntil:ba,nextPointUntil:ca,isCharPoint:da,walkPoint:ea,ancestor:H,singleChildAncestor:I,listAncestor:J,lastAncestor:K,listNext:N,listPrev:M,listDescendant:O,commonAncestor:L,wrap:P,insertAfter:Q,appendChildNodes:R,position:X,hasChildren:Y,makeOffsetPath:fa,fromOffsetPath:ga,splitTree:ia,splitPoint:ja,create:ka,createText:la,remove:ma,removeWhile:na,replace:oa,html:ra,value:qa}}(),k=function(){var b=function(a,b){var d,f,c=a.parentElement(),e=document.body.createTextRange(),h=g.from(c.childNodes);for(d=0;d<h.length;d++)if(!j.isText(h[d])){if(e.moveToElementText(h[d]),e.compareEndPoints("StartToStart",a)>=0)break;f=h[d]}if(0!==d&&j.isText(h[d-1])){var i=document.body.createTextRange(),k=null;i.moveToElementText(f||c),i.collapse(!f),k=f?f.nextSibling:c.firstChild;var l=a.duplicate();l.setEndPoint("StartToStart",i);for(var m=l.text.replace(/[\r\n]/g,"").length;m>k.nodeValue.length&&k.nextSibling;)m-=k.nodeValue.length,k=k.nextSibling;k.nodeValue;b&&k.nextSibling&&j.isText(k.nextSibling)&&m===k.nodeValue.length&&(m-=k.nodeValue.length,k=k.nextSibling),c=k,d=m}return{cont:c,offset:d}},c=function(a){var b=function(a,c){var d,e;if(j.isText(a)){var h=j.listPrev(a,f.not(j.isText)),i=g.last(h).previousSibling;d=i||a.parentNode,c+=g.sum(g.tail(h),j.nodeLength),e=!i}else{if(d=a.childNodes[c]||a,j.isText(d))return b(d,0);c=0,e=!1}return{node:d,collapseToStart:e,offset:c}},c=document.body.createTextRange(),d=b(a.node,a.offset);return c.moveToElementText(d.node),c.collapse(d.collapseToStart),c.moveStart("character",d.offset),c},d=function(b,h,i,k){this.sc=b,this.so=h,this.ec=i,this.eo=k;var l=function(){if(e.isW3CRangeSupport){var a=document.createRange();return a.setStart(b,h),a.setEnd(i,k),a}var d=c({node:b,offset:h});return d.setEndPoint("EndToEnd",c({node:i,offset:k})),d};this.getPoints=function(){return{sc:b,so:h,ec:i,eo:k}},this.getStartPoint=function(){return{node:b,offset:h}},this.getEndPoint=function(){return{node:i,offset:k}},this.select=function(){var a=l();if(e.isW3CRangeSupport){var b=document.getSelection();b.rangeCount>0&&b.removeAllRanges(),b.addRange(a)}else a.select();return this},this.normalize=function(){var a=function(a){return j.isVisiblePoint(a)||(a=j.isLeftEdgePoint(a)?j.nextPointUntil(a,j.isVisiblePoint):j.prevPointUntil(a,j.isVisiblePoint)),a},b=a(this.getStartPoint()),c=a(this.getEndPoint());return new d(b.node,b.offset,c.node,c.offset)},this.nodes=function(a,b){a=a||f.ok;var c=b&&b.includeAncestor,d=b&&b.fullyContains,e=this.getStartPoint(),h=this.getEndPoint(),i=[],k=[];return j.walkPoint(e,h,function(b){if(!j.isEditable(b.node)){var e;d?(j.isLeftEdgePoint(b)&&k.push(b.node),j.isRightEdgePoint(b)&&g.contains(k,b.node)&&(e=b.node)):e=c?j.ancestor(b.node,a):b.node,e&&a(e)&&i.push(e)}},!0),g.unique(i)},this.commonAncestor=function(){return j.commonAncestor(b,i)},this.expand=function(a){var c=j.ancestor(b,a),e=j.ancestor(i,a);if(!c&&!e)return new d(b,h,i,k);var f=this.getPoints();return c&&(f.sc=c,f.so=0),e&&(f.ec=e,f.eo=j.nodeLength(e)),new d(f.sc,f.so,f.ec,f.eo)},this.collapse=function(a){return a?new d(b,h,b,h):new d(i,k,i,k)},this.splitText=function(){var a=b===i,c=this.getPoints();return j.isText(i)&&!j.isEdgePoint(this.getEndPoint())&&i.splitText(k),j.isText(b)&&!j.isEdgePoint(this.getStartPoint())&&(c.sc=b.splitText(h),c.so=0,a&&(c.ec=c.sc,c.eo=k-h)),new d(c.sc,c.so,c.ec,c.eo)},this.deleteContents=function(){if(this.isCollapsed())return this;var b=this.splitText(),c=b.nodes(null,{fullyContains:!0}),e=j.prevPointUntil(b.getStartPoint(),function(a){return!g.contains(c,a.node)}),f=[];return a.each(c,function(a,b){var c=b.parentNode;e.node!==c&&1===j.nodeLength(c)&&f.push(c),j.remove(b,!1)}),a.each(f,function(a,b){j.remove(b,!1)}),new d(e.node,e.offset,e.node,e.offset).normalize()};var m=function(a){return function(){var c=j.ancestor(b,a);return!!c&&c===j.ancestor(i,a)}};this.isOnEditable=m(j.isEditable),this.isOnList=m(j.isList),this.isOnAnchor=m(j.isAnchor),this.isOnCell=m(j.isCell),this.isLeftEdgeOf=function(a){if(!j.isLeftEdgePoint(this.getStartPoint()))return!1;var b=j.ancestor(this.sc,a);return b&&j.isLeftEdgeOf(this.sc,b)},this.isCollapsed=function(){return b===i&&h===k},this.wrapBodyInlineWithPara=function(){if(j.isBodyContainer(b)&&j.isEmpty(b))return b.innerHTML=j.emptyPara,new d(b.firstChild,0,b.firstChild,0);if(j.isParaInline(b)||j.isPara(b))return this.normalize();var a;if(j.isInline(b)){var c=j.listAncestor(b,f.not(j.isInline));a=g.last(c),j.isInline(a)||(a=c[c.length-2]||b.childNodes[h])}else a=b.childNodes[h>0?h-1:0];var e=j.listPrev(a,j.isParaInline).reverse();if(e=e.concat(j.listNext(a.nextSibling,j.isParaInline)),e.length){var i=j.wrap(g.head(e),"p");j.appendChildNodes(i,g.tail(e))}return this.normalize()},this.insertNode=function(a){var b=this.wrapBodyInlineWithPara().deleteContents(),c=j.splitPoint(b.getStartPoint(),j.isInline(a));return c.rightNode?c.rightNode.parentNode.insertBefore(a,c.rightNode):c.container.appendChild(a),a},this.pasteHTML=function(b){var c=this,d=a("<div></div>").html(b)[0],e=g.from(d.childNodes);return this.wrapBodyInlineWithPara().deleteContents(),a.map(e.reverse(),function(a){return c.insertNode(a)}).reverse()},this.toString=function(){var a=l();return e.isW3CRangeSupport?a.toString():a.text},this.getWordRange=function(a){var b=this.getEndPoint();if(!j.isCharPoint(b))return this;var c=j.prevPointUntil(b,function(a){return!j.isCharPoint(a)});return a&&(b=j.nextPointUntil(b,function(a){return!j.isCharPoint(a)})),new d(c.node,c.offset,b.node,b.offset)},this.bookmark=function(a){return{s:{path:j.makeOffsetPath(a,b),offset:h},e:{path:j.makeOffsetPath(a,i),offset:k}}},this.paraBookmark=function(a){return{s:{path:g.tail(j.makeOffsetPath(g.head(a),b)),offset:h},e:{path:g.tail(j.makeOffsetPath(g.last(a),i)),offset:k}}},this.getClientRects=function(){return l().getClientRects()}};return{create:function(a,c,f,g){if(arguments.length)2===arguments.length&&(f=a,g=c);else if(e.isW3CRangeSupport){var h=document.getSelection();if(!h||0===h.rangeCount)return null;if(j.isBody(h.anchorNode))return null;var i=h.getRangeAt(0);a=i.startContainer,c=i.startOffset,f=i.endContainer,g=i.endOffset}else{var k=document.selection.createRange(),l=k.duplicate();l.collapse(!1);var m=k;m.collapse(!0);var n=b(m,!0),o=b(l,!1);j.isText(n.node)&&j.isLeftEdgePoint(n)&&j.isTextNode(o.node)&&j.isRightEdgePoint(o)&&o.node.nextSibling===n.node&&(n=o),a=n.cont,c=n.offset,f=o.cont,g=o.offset}return new d(a,c,f,g)},createFromNode:function(a){var b=a,c=0,d=a,e=j.nodeLength(d);return j.isVoid(b)&&(c=j.listPrev(b).length-1,b=b.parentNode),j.isBR(d)?(e=j.listPrev(d).length-1,d=d.parentNode):j.isVoid(d)&&(e=j.listPrev(d).length,d=d.parentNode),this.create(b,c,d,e)},createFromNodeBefore:function(a){return this.createFromNode(a).collapse(!0)},createFromNodeAfter:function(a){return this.createFromNode(a).collapse()},createFromBookmark:function(a,b){var c=j.fromOffsetPath(a,b.s.path),e=b.s.offset,f=j.fromOffsetPath(a,b.e.path),g=b.e.offset;return new d(c,e,f,g)},createFromParaBookmark:function(a,b){var c=a.s.offset,e=a.e.offset,f=j.fromOffsetPath(g.head(b),a.s.path),h=j.fromOffsetPath(g.last(b),a.e.path);return new d(f,c,h,e)}}}(),l={version:"0.6.9",options:{defaultTextColor:"#212121",defaultBackColor:"#ddd",followingToolbar:!0,otherStaticBarClass:"staticTop",width:null,height:null,minHeight:null,maxHeight:null,focus:!1,tabsize:4,styleWithSpan:!0,disableLinkTarget:!1,disableDragAndDrop:!1,disableResizeEditor:!1,shortcuts:!0,placeholder:!1,prettifyHtml:!0,iconPrefix:"",icons:{font:{bold:"format_bold",italic:"format_italic",underline:"format_underlined",clear:"clear",height:"format_size",strikethrough:"strikethrough_s",superscript:"vertical_align_top",subscript:"vertical_align_bottom"},image:{image:"image",floatLeft:"format_align_left",floatRight:"format_align_right",floatNone:"format_align_justify",shapeRounded:"crop_3_2",shapeCircle:"panorama_fish_eye",shapeThumbnail:"collections",bordered:"border_outer",shapeNone:"image",remove:"delete"},link:{link:"insert_link",unlink:"clear",edit:"create"},table:{table:"border_all"},hr:{insert:"add"},style:{style:"border_color"},lists:{unordered:"format_list_bulleted",ordered:"format_list_numbered"},options:{help:"help",fullscreen:"settings_overscan",codeview:"code"},paragraph:{paragraph:"format_textdirection_l_to_r",outdent:"format_indent_decrease",indent:"format_indent_increase",left:"format_align_left",center:"format_align_center",right:"format_align_right",justify:"format_align_justify"},color:{recent:"format_color_text"},history:{undo:"undo",redo:"redo"},misc:{check:"check"}},codemirror:{mode:"text/html",htmlMode:!0,indentWithTabs:!0,tabSize:4,lineNumbers:!0,theme:"monokai",maxHighlightLength:"Infinity"},lang:"en-US",direction:null,toolbar:[["style",["style"]],["font",["bold","italic","underline","clear"]],["fontname",["fontname"]],["fontsize",["fontsize"]],["color",["color"]],["para",["ul","ol","paragraph"]],["height",["height"]],["table",["table"]],["insert",["link","picture","hr"]],["view",["fullscreen","codeview"]],["help",["help"]]],plugin:{},airMode:!1,airPopover:[["color",["color"]],["font",["bold","underline","clear"]],["para",["ul","paragraph"]],["table",["table"]],["insert",["link","picture"]]],styleTags:["p","blockquote","pre","h1","h2","h3","h4","h5","h6"],defaultFontName:"Roboto",fontNames:["Roboto","Arial","Arial Black","Comic Sans MS","Courier New","Helvetica Neue","Helvetica","Impact","Times New Roman","Verdana"],fontNamesIgnoreCheck:[],fontSizes:["12","13","14","15","16","17","18","25","37"],colors:[["#fafafa","#efebe9","#7e57c2","#ab47bc","#5c6bc0","#42a5f5","#26c6da","#66bb6a","#9ccc65","#ffee58","#ffca28","#ffa726","#ff7043","#ef5350","#ec407a"],["#f5f5f5","#d7ccc8","#673ab7","#9c27b0","#3f51b5","#2196f3","#00bcd4","#4caf50","#8bc34a","#ffeb3b","#ffc107","#ff9800","#ff5722","#f44336","#e91e63"],["#eeeeee","#bcaaa4","#5e35b1","#8e24aa","#3949ab","#1e88e5","#00acc1","#43a047","#7cb342","#fdd835","#ffb300","#fb8c00","#f4511e","#e53935","#d81b60"],["#e0e0e0","#a1887f","#512da8","#7b1fa2","#303f9f","#1976d2","#0097a7","#388e3c","#689f38","#fbc02d","#ffa000","#f57c00","#e64a19","#d32f2f","#c2185b"],["#bdbdbd","#8d6e63","#4527a0","#6a1b9a","#283593","#1565c0","#00838f","#2e7d32","#558b2f","#f9a825","#ff8f00","#ef6c00","#d84315","#c62828","#ad1457"],["#9e9e9e","#795548","#311b92","#4a148c","#1a237e","#0d47a1","#006064","#1b5e20","#33691e","#f57f17","#ff6f00","#e65100","#bf360c","#b71c1c","#880e4f"],["#757575","#6d4c41","#b388ff","#ea80fc","#8c9eff","#82b1ff","#84ffff","#b9f6ca","#ccff90","#ffff8d","#ffe57f","#ffd180","#ff9e80","#ff8a80","#ff80ab"],["#616161","#5d4037","#7c4dff","#e040fb","#536dfe","#448aff","#18ffff","#69f0ae","#b2ff59","#ffff00","#ffd740","#ffab40","#ff6e40","#ff5252","#ff4081"],["#424242","#4e342e","#651fff","#d500f9","#3d5afe","#2979ff","#00e5ff","#00e676","#76ff03","#ffea00","#ffc400","#ff9100","#ff3d00","#ff1744","#f50057"],["#212121","#3e2723","#6200ea","#aa00ff","#304ffe","#2962ff","#00b8d4","#00c853","#64dd17","#ffd600","#ffab00","#ff6d00","#dd2c00","#d50000","#c51162"]],colorTitles:[["grey lighten5","brown lighten5","deep-purple lighten1","purple lighten1","indigo lighten1","blue lighten1","cyan lighten1","green lighten1","light-green lighten1","yellow lighten1","amber lighten1","orange lighten1","deep-orange lighten1","red lighten1","pink lighten1"],["grey lighten4","brown lighten4","deep-purple","purple","indigo","blue","cyan","green","light-green","yellow","amber","orange","deep-orange","red","pink"],["grey lighten3","brown lighten3","deep-purple darken1","purple darken1","indigo darken1","blue darken1","cyan darken1","green darken1","light-green darken1","yellow darken1","amber darken1","orange darken1","deep-orange darken1","red darken1","pink darken1"],["grey lighten2","brown lighten2","deep-purple darken2","purple darken2","indigo darken2","blue darken2","cyan darken2","green darken2","light-green darken2","yellow darken2","amber darken2","orange darken2","deep-orange darken2","red darken2","pink darken2"],["grey lighten1","brown lighten1","deep-purple darken3","purple darken3","indigo darken3","blue darken3","cyan darken3","green darken3","light-green darken3","yellow darken3","amber darken3","orange darken3","deep-orange darken3","red darken3","pink darken3"],["grey","brown","deep-purple darken4","purple darken4","indigo darken4","blue darken4","cyan darken4","green darken4","light-green darken4","yellow darken4","amber darken4","orange darken4","deep-orange darken4","red darken4","pink darken4"],["grey darken1","brown darken1","deep-purple accent1","purple accent1","indigo accent1","blue accent1","cyan accent1","green accent1","light-green accent1","yellow accent1","amber accent1","orange accent1","deep-orange accent1","red accent1","pink accent1"],["grey darken2","brown darken2","deep-purple accent2","purple accent2","indigo accent2","blue accent2","cyan accent2","green accent2","light-green accent2","yellow accent2","amber accent2","orange accent2","deep-orange accent2","red accent2","pink accent2"],["grey darken3","brown darken3","deep-purple accent3","purple accent3","indigo accent3","blue accent3","cyan accent3","green accent3","light-green accent3","yellow accent3","amber accent3","orange accent3","deep-orange accent3","red accent3","pink accent3"],["grey darken4","brown darken4","deep-purple accent4","purple accent4","indigo accent4","blue accent4","cyan accent4","green accent4","light-green accent4","yellow accent4","amber accent4","orange accent4","deep-orange accent4","red accent4","pink accent4"]],lineHeights:["1.0","1.2","1.4","1.5","1.6","1.8","2.0","3.0"],insertTableMaxSize:{col:12,row:10},maximumImageFileSize:null,oninit:null,onfocus:null,onblur:null,onenter:null,onkeyup:null,onkeydown:null,onImageUpload:null,onImageUploadError:null,onMediaDelete:null,onToolbarClick:null,onsubmit:null,onCreateLink:function(a){return-1!==a.indexOf("@")&&-1===a.indexOf(":")&&(a="mailto:"+a),a},keyMap:{pc:{ENTER:"insertParagraph","CTRL+Z":"undo","CTRL+Y":"redo",TAB:"tab","SHIFT+TAB":"untab","CTRL+B":"bold","CTRL+I":"italic","CTRL+U":"underline","CTRL+SHIFT+S":"strikethrough","CTRL+BACKSLASH":"removeFormat","CTRL+SHIFT+L":"justifyLeft","CTRL+SHIFT+E":"justifyCenter","CTRL+SHIFT+R":"justifyRight","CTRL+SHIFT+J":"justifyFull","CTRL+SHIFT+NUM7":"insertUnorderedList","CTRL+SHIFT+NUM8":"insertOrderedList","CTRL+LEFTBRACKET":"outdent","CTRL+RIGHTBRACKET":"indent","CTRL+NUM0":"formatPara","CTRL+NUM1":"formatH1","CTRL+NUM2":"formatH2","CTRL+NUM3":"formatH3","CTRL+NUM4":"formatH4","CTRL+NUM5":"formatH5","CTRL+NUM6":"formatH6","CTRL+ENTER":"insertHorizontalRule","CTRL+K":"showLinkDialog"},mac:{ENTER:"insertParagraph","CMD+Z":"undo","CMD+SHIFT+Z":"redo",TAB:"tab","SHIFT+TAB":"untab","CMD+B":"bold","CMD+I":"italic","CMD+U":"underline","CMD+SHIFT+S":"strikethrough","CMD+BACKSLASH":"removeFormat","CMD+SHIFT+L":"justifyLeft","CMD+SHIFT+E":"justifyCenter","CMD+SHIFT+R":"justifyRight","CMD+SHIFT+J":"justifyFull","CMD+SHIFT+NUM7":"insertUnorderedList","CMD+SHIFT+NUM8":"insertOrderedList","CMD+LEFTBRACKET":"outdent","CMD+RIGHTBRACKET":"indent","CMD+NUM0":"formatPara","CMD+NUM1":"formatH1","CMD+NUM2":"formatH2","CMD+NUM3":"formatH3","CMD+NUM4":"formatH4","CMD+NUM5":"formatH5","CMD+NUM6":"formatH6","CMD+ENTER":"insertHorizontalRule","CMD+K":"showLinkDialog"}}},lang:{"en-US":{font:{bold:"Bold",italic:"Italic",underline:"Underline",clear:"Remove Font Style",height:"Line Height",name:"Font Family",strikethrough:"Strikethrough",subscript:"Subscript",superscript:"Superscript",size:"Font Size"},image:{image:"Picture",insert:"Insert Image",resizeFull:"Resize Full",resizeHalf:"Resize Half",resizeQuarter:"Resize Quarter",floatLeft:"Float Left",floatRight:"Float Right",floatNone:"Float None",shapeRounded:"Shape: Rounded",shapeCircle:"Shape: Circle",bordered:"Bordered",shapeThumbnail:"Shape: Thumbnail",shapeNone:"Shape: None",dragImageHere:"Drag image or text here",dropImage:"Drop image or Text",selectFromFiles:"Select from files",maximumFileSize:"Maximum file size",maximumFileSizeError:"Maximum file size exceeded.",url:"Image URL",remove:"Remove Image"},link:{link:"Link",insert:"Insert Link",unlink:"Unlink",edit:"Edit",textToDisplay:"Text to display",url:"To what URL should this link go?",openInNewWindow:"Open in new window"},table:{table:"Table",striped:"Striped",hoverable:"Hoverable",responsive:"Responsive",bordered:"Bordered"},hr:{insert:"Insert Horizontal Rule"},style:{style:"Style",normal:"Normal",blockquote:"Quote",pre:"Code",h1:"Header 1",h2:"Header 2",h3:"Header 3",h4:"Header 4",h5:"Header 5",h6:"Header 6"},lists:{unordered:"Unordered list",ordered:"Ordered list"},options:{help:"Help",fullscreen:"Full Screen",codeview:"Code View"},paragraph:{paragraph:"Paragraph",outdent:"Outdent",indent:"Indent",left:"Align left",center:"Align center",right:"Align right",justify:"Justify full"},color:{recent:"Recent Color",more:"More Color",background:"Back",foreground:"Text",transparent:"Transparent",setTransparent:"Transparent",reset:"Reset",resetToDefault:"Default"},shortcut:{shortcuts:"Keyboard shortcuts",close:"Close",textFormatting:"Text formatting",action:"Action",paragraphFormatting:"Paragraph formatting",documentStyle:"Document Style",extraKeys:"Extra keys"},history:{undo:"Undo",redo:"Redo"}}}},m=function(){return{readFileAsDataURL:function(b){return a.Deferred(function(c){a.extend(new FileReader,{onload:function(a){var b=a.target.result;c.resolve(b)},onerror:function(){c.reject(this)}}).readAsDataURL(b)}).promise()},createImage:function(b,c){return a.Deferred(function(d){var e=a("<img>");e.one("load",function(){e.off("error abort"),d.resolve(e)}).one("error abort",function(){e.off("load").detach(),d.reject(e)}).css({display:"none"}).appendTo(document.body).attr({src:b,"data-filename":c})}).promise()}}}(),n=function(){var a={BACKSPACE:8,TAB:9,ENTER:13,SPACE:32,NUM0:48,NUM1:49,NUM2:50,NUM3:51,NUM4:52,NUM5:53,NUM6:54,NUM7:55,NUM8:56,B:66,E:69,I:73,J:74,K:75,L:76,R:82,S:83,U:85,Y:89,Z:90,SLASH:191,LEFTBRACKET:219,BACKSLASH:220,RIGHTBRACKET:221};return{isEdit:function(a){return g.contains([8,9,13,32],a)},isMove:function(a){return g.contains([37,38,39,40],a)},nameFromCode:f.invertObject(a),code:a}}(),o=function(a){var b=[],c=-1,d=a[0],e=function(){var b=k.create(),c={s:{path:[],offset:0},e:{path:[],offset:0}};return{contents:a.html(),bookmark:b?b.bookmark(d):c}},f=function(b){null!==b.contents&&a.html(b.contents),null!==b.bookmark&&k.createFromBookmark(d,b.bookmark).select()};this.undo=function(){0<c&&(c--,f(b[c]))},this.redo=function(){b.length-1>c&&(c++,f(b[c]))},this.recordUndo=function(){c++,b.length>c&&(b=b.slice(0,c)),b.push(e())},this.recordUndo()},p=function(){var b=function(b,c){if(e.jqueryVersion<1.9){var d={};return a.each(c,function(a,c){d[c]=b.css(c)}),d}return b.css.call(b,c)};this.stylePara=function(b,c){a.each(b.nodes(j.isPara,{includeAncestor:!0}),function(b,d){a(d).css(c)})},this.styleNodes=function(b,c){b=b.splitText();var d=c&&c.nodeName||"SPAN",e=!(!c||!c.expandClosestSibling),h=!(!c||!c.onlyPartialContains);if(b.isCollapsed())return[b.insertNode(j.create(d))];var i=j.makePredByNodeName(d),k=a.map(b.nodes(j.isText,{fullyContains:!0}),function(a){return j.singleChildAncestor(a,i)||j.wrap(a,d)});if(e){if(h){var l=b.nodes();i=f.and(i,function(a){return g.contains(l,a)})}return a.map(k,function(b){var c=j.withClosestSiblings(b,i),d=g.head(c),e=g.tail(c);return a.each(e,function(a,b){j.appendChildNodes(d,b.childNodes),j.remove(b)}),g.head(c)})}return k},this.current=function(c,d){var e=a(j.isText(c.sc)?c.sc.parentNode:c.sc),f=["font-family","font-size","text-align","list-style-type","line-height"],g=b(e,f)||{};if(g["font-size"]=parseInt(g["font-size"],10),g["font-bold"]=document.queryCommandState("bold")?"bold":"normal",g["font-italic"]=document.queryCommandState("italic")?"italic":"normal",g["font-underline"]=document.queryCommandState("underline")?"underline":"normal",g["font-strikethrough"]=document.queryCommandState("strikeThrough")?"strikethrough":"normal",g["font-superscript"]=document.queryCommandState("superscript")?"superscript":"normal",g["font-subscript"]=document.queryCommandState("subscript")?"subscript":"normal",c.isOnList()){var h=["circle","disc","disc-leading-zero","square"],i=a.inArray(g["list-style-type"],h)>-1;g["list-style"]=i?"unordered":"ordered"}else g["list-style"]="none";var k=j.ancestor(c.sc,j.isPara);if(k&&k.style["line-height"])g["line-height"]=k.style.lineHeight;else{var l=parseInt(g["line-height"],10)/parseInt(g["font-size"],10);g["line-height"]=l.toFixed(1)}return g.image=j.isImg(d)&&d,g.anchor=c.isOnAnchor()&&j.ancestor(c.sc,j.isAnchor),g.ancestors=j.listAncestor(c.sc,j.isEditable),g.range=c,g}},q=function(){this.insertOrderedList=function(){this.toggleList("OL")},this.insertUnorderedList=function(){this.toggleList("UL")},this.indent=function(){var b=this,c=k.create().wrapBodyInlineWithPara(),d=c.nodes(j.isPara,{includeAncestor:!0}),e=g.clusterBy(d,f.peq2("parentNode"));a.each(e,function(c,d){var e=g.head(d);j.isLi(e)?b.wrapList(d,e.parentNode.nodeName):a.each(d,function(b,c){a(c).css("marginLeft",function(a,b){return(parseInt(b,10)||0)+25})})}),c.select()},this.outdent=function(){var b=this,c=k.create().wrapBodyInlineWithPara(),d=c.nodes(j.isPara,{includeAncestor:!0}),e=g.clusterBy(d,f.peq2("parentNode"));a.each(e,function(c,d){var e=g.head(d);j.isLi(e)?b.releaseList([d]):a.each(d,function(b,c){a(c).css("marginLeft",function(a,b){return b=parseInt(b,10)||0,b>25?b-25:""})})}),c.select()},this.toggleList=function(b){var c=this,d=k.create().wrapBodyInlineWithPara(),e=d.nodes(j.isPara,{includeAncestor:!0}),h=d.paraBookmark(e),i=g.clusterBy(e,f.peq2("parentNode"));if(g.find(e,j.isPurePara)){var l=[];a.each(i,function(a,d){l=l.concat(c.wrapList(d,b))}),e=l}else{var m=d.nodes(j.isList,{includeAncestor:!0}).filter(function(c){return!a.nodeName(c,b)});m.length?a.each(m,function(a,c){j.replace(c,b)}):e=this.releaseList(i,!0)}k.createFromParaBookmark(h,e).select()},this.wrapList=function(b,c){var d=g.head(b),e=g.last(b),f=j.isList(d.previousSibling)&&d.previousSibling,h=j.isList(e.nextSibling)&&e.nextSibling,i=f||j.insertAfter(j.create(c||"UL"),e);return b=a.map(b,function(a){return j.isPurePara(a)?j.replace(a,"LI"):a}),j.appendChildNodes(i,b),h&&(j.appendChildNodes(i,g.from(h.childNodes)),j.remove(h)),b},this.releaseList=function(b,c){var d=[];return a.each(b,function(b,e){var f=g.head(e),h=g.last(e),i=c?j.lastAncestor(f,j.isList):f.parentNode,k=i.childNodes.length>1?j.splitTree(i,{node:h.parentNode,offset:j.position(h)+1},{isSkipPaddingBlankHTML:!0}):null,l=j.splitTree(i,{node:f.parentNode,offset:j.position(f)},{isSkipPaddingBlankHTML:!0});e=c?j.listDescendant(l,j.isLi):g.from(l.childNodes).filter(j.isLi),!c&&j.isList(i.parentNode)||(e=a.map(e,function(a){return j.replace(a,"P")})),a.each(g.from(e).reverse(),function(a,b){j.insertAfter(b,i)});var m=g.compact([i,l,k]);a.each(m,function(b,c){var d=[c].concat(j.listDescendant(c,j.isList));a.each(d.reverse(),function(a,b){j.nodeLength(b)||j.remove(b,!0)})}),d=d.concat(e)}),d}},r=function(){var b=new q;this.insertTab=function(a,b,c){var d=j.createText(new Array(c+1).join(j.NBSP_CHAR));b=b.deleteContents(),b.insertNode(d,!0),b=k.create(d,c),b.select()},this.insertParagraph=function(){var c=k.create();c=c.deleteContents(),c=c.wrapBodyInlineWithPara();var e,d=j.ancestor(c.sc,j.isPara);if(d){if(j.isEmpty(d)&&j.isLi(d))return void b.toggleList(d.parentNode.nodeName);e=j.splitTree(d,c.getStartPoint());var f=j.listDescendant(d,j.isEmptyAnchor);f=f.concat(j.listDescendant(e,j.isEmptyAnchor)),a.each(f,function(a,b){j.remove(b)})}else{var g=c.sc.childNodes[c.so];e=a(j.emptyPara)[0],g?c.sc.insertBefore(e,g):c.sc.appendChild(e)}k.create(e,0).normalize().select()}},s=function(){this.tab=function(a,b){var c=j.ancestor(a.commonAncestor(),j.isCell),d=j.ancestor(c,j.isTable),e=j.listDescendant(d,j.isCell),f=g[b?"prev":"next"](e,c);f&&k.create(f,0).select()},this.createTable=function(b){for(var d,c=[],e=[],f=b[0],g=b[1],h=b.slice(2,b.length),i=0;i<f;i++)c.push("<td>(item)</td>"),e.push("<th>header</th>");d=c.join(""),e=e.join("");for(var k,j=[],l=0;l<g;l++)j.push("<tr>"+d+"</tr>");return k=j.join(""),a('<table class="'+h.join(" ")+'"><thead><tr>'+e+"</tr></thead><tbody>"+k+"</tbody></table>")[0]}},t="bogus",u=function(b){var c=new p,d=new s,f=new r,h=new q;this.createRange=function(a){return this.focus(a),k.create()},this.saveRange=function(a,b){this.focus(a),a.data("range",k.create()),b&&k.create().collapse().select()},this.saveNode=function(a){for(var b=[],c=0,d=a[0].childNodes.length;c<d;c++)b.push(a[0].childNodes[c]);a.data("childNodes",b)},this.restoreRange=function(a){var b=a.data("range");b&&(b.select(),this.focus(a))},this.restoreNode=function(a){a.html("");for(var b=a.data("childNodes"),c=0,d=b.length;c<d;c++)a[0].appendChild(b[c])},this.currentStyle=function(a){var b=k.create();return!!b&&(b.isOnEditable()&&c.current(b,a))};var i=function(a){var c=j.makeLayoutInfo(a).holder();b.bindCustomEvent(c,a.data("callbacks"),"before.command")(a.html(),a)},l=function(a){var c=j.makeLayoutInfo(a).holder();b.bindCustomEvent(c,a.data("callbacks"),"change")(a.html(),a)};this.undo=function(a){i(a),a.data("NoteHistory").undo(),l(a)},this.redo=function(a){i(a),a.data("NoteHistory").redo(),l(a)};for(var n=this,o=this.beforeCommand=function(a){i(a),n.focus(a)},u=this.afterCommand=function(a,b){a.data("NoteHistory").recordUndo(),b||l(a)},v=["bold","italic","underline","strikethrough","superscript","subscript","justifyLeft","justifyCenter","justifyRight","justifyFull","formatBlock","removeFormat","backColor","foreColor","fontName"],w=0,x=v.length;w<x;w++)this[v[w]]=function(a){return function(b,c){o(b),document.execCommand(a,!1,c),u(b,!0)}}(v[w]);this.insertHorizontalRule=function(){var b=a("<div />");b.addClass("divider"),k.create().insertNode(b[0])},this.tab=function(a,b){var c=this.createRange(a);c.isCollapsed()&&c.isOnCell()?d.tab(c):(o(a),f.insertTab(a,c,b.tabsize),u(a))},this.untab=function(a){var b=this.createRange(a);b.isCollapsed()&&b.isOnCell()&&d.tab(b,!0)},this.insertParagraph=function(a){o(a),f.insertParagraph(a),u(a)},this.insertOrderedList=function(a){o(a),h.insertOrderedList(a),u(a)},this.insertUnorderedList=function(a){o(a),h.insertUnorderedList(a),u(a)},this.indent=function(a){o(a),h.indent(a),u(a)},this.outdent=function(a){o(a),h.outdent(a),u(a)},this.insertImage=function(a,c,d){m.createImage(c,d).then(function(b){o(a),b.css({display:"",width:Math.min(a.width(),b.width())}),k.create().insertNode(b[0]),k.createFromNodeAfter(b[0]).select(),u(a)}).fail(function(){var c=j.makeLayoutInfo(a).holder();b.bindCustomEvent(c,a.data("callbacks"),"image.upload.error")()})},this.insertNode=function(a,b){o(a),k.create().insertNode(b),k.createFromNodeAfter(b).select(),u(a)},this.insertText=function(a,b){o(a);var c=k.create().insertNode(j.createText(b));k.create(c,j.nodeLength(c)).select(),u(a)},this.pasteHTML=function(a,b){o(a);var c=k.create().pasteHTML(b);k.createFromNodeAfter(g.last(c)).select(),u(a)},this.formatBlock=function(a,b){o(a),b=e.isMSIE?"<"+b+">":b,document.execCommand("FormatBlock",!1,b),u(a)},this.formatPara=function(a){o(a),this.formatBlock(a,"P"),u(a)};for(var w=1;w<=6;w++)this["formatH"+w]=function(a){return function(b){this.formatBlock(b,"H"+a)}}(w);this.fontSize=function(b,d){var e=k.create();if(e.isCollapsed()){var h=c.styleNodes(e),i=g.head(h);a(h).css({"font-size":d+"px"}),i&&!j.nodeLength(i)&&(i.innerHTML=j.ZERO_WIDTH_NBSP_CHAR,k.createFromNodeAfter(i.firstChild).select(),b.data(t,i))}else o(b),a(c.styleNodes(e)).css({"font-size":d+"px"}),u(b)},this.removeBogus=function(a){var b=a.data(t);if(b){var c=g.find(g.from(b.childNodes),j.isText),d=c.nodeValue.indexOf(j.ZERO_WIDTH_NBSP_CHAR);-1!==d&&c.deleteData(d,1),j.isEmpty(b)&&j.remove(b),a.removeData(t)}},this.lineHeight=function(a,b){o(a),c.stylePara(k.create(),{lineHeight:b}),u(a)},this.unlink=function(a){var b=this.createRange(a);if(b.isOnAnchor()){var c=j.ancestor(b.sc,j.isAnchor);b=k.createFromNode(c),b.select(),o(a),document.execCommand("unlink"),u(a)}},this.createLink=function(b,d,e){var f=d.url,h=d.text,i=d.newWindow,j=d.range,l=j.toString()!==h;o(b),e.onCreateLink&&(f=e.onCreateLink(f));var m=[];if(l){var n=j.insertNode(a("<A>"+h+"</A>")[0]);m.push(n)}else m=c.styleNodes(j,{nodeName:"A",expandClosestSibling:!0,onlyPartialContains:!0});a.each(m,function(b,c){a(c).attr("href",f),i?a(c).attr("target","_blank"):a(c).removeAttr("target")});var p=k.createFromNodeBefore(g.head(m)),q=p.getStartPoint(),r=k.createFromNodeAfter(g.last(m)),s=r.getEndPoint();k.create(q.node,q.offset,s.node,s.offset).select(),u(b)},this.getLinkInfo=function(b){this.focus(b);var c=k.create().expand(j.isAnchor),d=a(g.head(c.nodes(j.isAnchor)));return{range:c,text:c.toString(),isNewWindow:!!d.length&&"_blank"===d.attr("target"),url:d.length?d.attr("href"):""}},this.color=function(a,b){var c=JSON.parse(b),d=c.foreColor,e=c.backColor;o(a),d&&document.execCommand("foreColor",!1,d),e&&document.execCommand("backColor",!1,e),u(a)},this.insertTable=function(a,b){var c=b.split("x");o(a),k.create().deleteContents().insertNode(d.createTable(c)),u(a)},this.floatMe=function(a,b,c){o(a),c.css("float",b),u(a)},this.imageShape=function(a,b,c){o(a),c.removeClass("img-rounded img-circle img-thumbnail img-bordered"),b&&c.addClass(b),u(a)},this.imageClass=function(a,b,c){o(a),b&&(c.hasClass(b)?c.removeClass(b):c.addClass(b)),u(a)},this.resize=function(a,b,c){o(a),c.css({width:100*b+"%",height:""}),u(a)},this.resizeTo=function(a,b,c){var d;if(c){var e=a.y/a.x,f=b.data("ratio");d={width:f>e?a.x:a.y/f,height:f>e?a.x*f:a.y}}else d={width:a.x,height:a.y};b.css(d)},this.removeMedia=function(c,d,e){o(c),e.detach(),b.bindCustomEvent(a(),c.data("callbacks"),"media.delete")(e,c),u(c)},this.focus=function(a){a.focus(),e.isFF&&!k.create().isOnEditable()&&k.createFromNode(a[0]).normalize().collapse().select()},this.isEmpty=function(a){return j.isEmpty(a[0])||j.emptyPara===a.html()}},v=function(){this.update=function(b,c){var d=function(b,c){b.find(".dropdown-menu li").each(function(){var b=a(this).children("div");b.data("value")+""==c+""?b.children("i").removeClass("transparent"):b.children("i").addClass("transparent")})},f=function(a,c){b.find(a).toggleClass("active",c())};if(c.image){var g=a(c.image);f('.btn[data-event="imageClass"][data-value="img-rounded"]',function(){return g.hasClass("img-rounded")}),f('.btn[data-event="imageClass"][data-value="img-circle"]',function(){return g.hasClass("img-circle")}),f('.btn[data-event="imageClass"][data-value="img-thumbnail"]',function(){return g.hasClass("img-thumbnail")}),f('.btn[data-event="imageClass"][data-value="img-bordered"]',function(){return g.hasClass("img-bordered")}),f('.btn[data-event="imageShape"]:not([data-value])',function(){return!g.is(".img-rounded, .img-circle, .img-thumbnail, .img-bordered")});var h=g.css("float");f('.btn[data-event="floatMe"][data-value="left"]',function(){return"left"===h}),f('.btn[data-event="floatMe"][data-value="right"]',function(){return"right"===h}),f('.btn[data-event="floatMe"][data-value="none"]',function(){return"left"!==h&&"right"!==h});var i=g.attr("style");return f('.btn[data-event="resize"][data-value="1"]',function(){return!!/(^|\s)(max-)?width\s*:\s*100%/.test(i)}),f('.btn[data-event="resize"][data-value="0.5"]',function(){return!!/(^|\s)(max-)?width\s*:\s*50%/.test(i)}),void f('.btn[data-event="resize"][data-value="0.25"]',function(){return!!/(^|\s)(max-)?width\s*:\s*25%/.test(i)})}var j=b.find(".note-fontname[data-name=fontname]");if(j.length){var k=c["font-family"];if(k){for(var l=k.split(","),m=0,n=l.length;m<n&&(k=l[m].replace(/[\'\"]/g,"").replace(/\s+$/,"").replace(/^\s+/,""),!e.isFontInstalled(k));m++);j.find(".note-current-fontname").text(k),d(j,k)}}var o=b.find(".note-fontsize[data-name=fontsize]");o.find(".note-current-fontsize").text(c["font-size"]),d(o,parseFloat(c["font-size"])),d(b.find(".note-height[data-name=lineheight]"),parseFloat(c["line-height"])),f('.btn[data-event="bold"]',function(){return"bold"===c["font-bold"]}),f('.btn[data-event="italic"]',function(){return"italic"===c["font-italic"]}),f('.btn[data-event="underline"]',function(){return"underline"===c["font-underline"]}),f('.btn[data-event="strikethrough"]',function(){return"strikethrough"===c["font-strikethrough"]}),f('.btn[data-event="superscript"]',function(){return"superscript"===c["font-superscript"]}),f('.btn[data-event="subscript"]',function(){return"subscript"===c["font-subscript"]}),f('.btn[data-event="justifyLeft"]',function(){return"left"===c["text-align"]||"start"===c["text-align"]}),f('.btn[data-event="justifyCenter"]',function(){return"center"===c["text-align"]}),f('.btn[data-event="justifyRight"]',function(){return"right"===c["text-align"]}),f('.btn[data-event="justifyFull"]',function(){return"justify"===c["text-align"]}),f('.btn[data-event="insertUnorderedList"]',function(){return"unordered"===c["list-style"]}),f('.btn[data-event="insertOrderedList"]',function(){return"ordered"===c["list-style"]})},this.updateRecentColor=function(b,c,d){var e=a(b).closest(".note-color"),f=e.find(".note-recent-color"),g=JSON.parse(f.attr("data-value")),h="backColor"===c?"background-color":"color";g[c]=d,f.attr("data-value",JSON.stringify(g)),f.css(h,d)}},w=function(){var a=new v;this.update=function(b,c){a.update(b,c)},this.updateRecentColor=function(b,c,d){a.updateRecentColor(b,c,d)},this.activate=function(a){a.find("button, .btn").not('.btn[data-event="codeview"]').removeClass("disabled")},this.deactivate=function(a){a.find("button, .btn").not('.btn[data-event="codeview"]').addClass("disabled")},this.updateFullscreen=function(a,b){a.find('.btn[data-event="fullscreen"]').toggleClass("active",b)},this.updateCodeview=function(a,b){a.find('.btn[data-event="codeview"]').toggleClass("active",b),b?this.deactivate(a):this.activate(a)},this.get=function(a,b){return j.makeLayoutInfo(a).toolbar().find("[data-name="+b+"]")},this.setButtonState=function(a,b,c){c=!1!==c,this.get(a,b).toggleClass("active",c)}},x=24,y=function(){var b=a(document);this.attach=function(a,b){b.disableResizeEditor||a.statusbar().on("mousedown",c)};var c=function(a){a.preventDefault(),a.stopPropagation();var c=j.makeLayoutInfo(a.target).editable(),d=c.offset().top-b.scrollTop(),e=j.makeLayoutInfo(a.currentTarget||a.target),f=e.editor().data("options");b.on("mousemove",function(a){var b=a.clientY-(d+x);b=f.minHeight>0?Math.max(b,f.minHeight):b,b=f.maxHeight>0?Math.min(b,f.maxHeight):b,c.height(b)}).one("mouseup",function(){b.off("mousemove")})}},z=function(){var b=new v,c=function(b,c){var d=a(b),e=c?d.offset():d.position(),f=d.outerHeight(!0);return{left:e.left,top:e.top+f}},d=function(a,b){a.css({display:"block",left:b.left,top:b.top})};this.update=function(h,i,j){b.update(h,i);var k=h.find(".note-link-popover");if(i.anchor){var l=k.find("a"),m=a(i.anchor).attr("href"),n=a(i.anchor).attr("target");l.attr("href",m).html(m),n?l.attr("target","_blank"):l.removeAttr("target"),d(k,c(i.anchor,j))}else k.hide();var o=h.find(".note-image-popover");i.image?d(o,c(i.image,j)):o.hide();var p=h.find(".note-air-popover");if(j&&!i.range.isCollapsed()){var q=g.last(i.range.getClientRects());if(q){var r=f.rect2bnd(q);d(p,{left:Math.max(r.left+r.width/2-20,0),top:r.top+r.height})}}else p.hide()},this.updateRecentColor=function(a,b,c){a.updateRecentColor(a,b,c)},this.hide=function(a){a.children().hide()}},A=function(b){var c=a(document),d=function(d){if(j.isControlSizing(d.target)){d.preventDefault(),d.stopPropagation();var e=j.makeLayoutInfo(d.target),f=e.handle(),g=e.popover(),h=e.editable(),i=e.editor(),k=f.find(".note-control-selection").data("target"),l=a(k),m=l.offset(),n=c.scrollTop(),o=i.data("options").airMode;c.on("mousemove",function(a){b.invoke("editor.resizeTo",{x:a.clientX-m.left,y:a.clientY-(m.top-n)},l,!a.shiftKey),b.invoke("handle.update",f,{image:k},o),b.invoke("popover.update",g,{image:k},o)}).one("mouseup",function(){c.off("mousemove"),b.invoke("editor.afterCommand",h)}),l.data("ratio")||l.data("ratio",l.height()/l.width())}};this.attach=function(a){a.handle().on("mousedown",d)},this.update=function(b,c,d){var e=b.find(".note-control-selection");if(c.image){var f=a(c.image),g=d?f.offset():f.position(),h={w:f.outerWidth(!0),h:f.outerHeight(!0)};e.css({display:"block",left:g.left,top:g.top,width:h.w,height:h.h}).data("target",c.image);var i=h.w+"x"+h.h;e.find(".note-control-selection-info").text(i)}else e.hide()},this.hide=function(a){a.children().hide()}},B=function(b){var c=a(window),d=a("html, body");this.toggle=function(a){var e=a.editor(),f=a.toolbar(),g=a.editable(),h=a.codable(),i=function(a){g.css("height",a.h),h.css("height",a.h),h.data("cmeditor")&&h.data("cmeditor").setsize(null,a.h)};e.toggleClass("fullscreen");var j=e.hasClass("fullscreen");j?(g.data("orgheight",g.css("height")),c.on("resize",function(){i({h:c.height()-f.outerHeight()})}).trigger("resize"),d.css("overflow","hidden"),f.css("top",0)):(c.off("resize"),i({h:g.data("orgheight")}),d.css("overflow","visible")),b.invoke("toolbar.updateFullscreen",f,j)}};e.hasCodeMirror&&(e.isSupportAmd?require(["CodeMirror"],function(a){C=a}):C=window.CodeMirror);var D=function(b){this.sync=function(a){b.invoke("codeview.isActivated",a)&&e.hasCodeMirror&&a.codable().data("cmEditor").save()},this.isActivated=function(a){return a.editor().hasClass("codeview")},this.toggle=function(a){this.isActivated(a)?this.deactivate(a):this.activate(a)},this.activate=function(c){function n(a,b,c,d){var g,e=a.indexOf("<"),f=a.indexOf(">");if(0===e)if(g=a.substring(0,f+1),a=a.substring(f+1),0===g.indexOf("</"))b--,nsideLastBlock=!1;else{c&&b++;for(var h=!1,i=0;i<d.length;i++)if(0===g.indexOf(d[i])){h=!0;break}c=!h}else g=a.substring(0,e),a=a.substring(e),c&&b++,c=!1;return g=new Array(b+1).join("    ")+g.trim(),0===a.length?g:g+"\n"+n(a.trim(),b,c,d)}var d=c.editor(),f=c.toolbar(),g=c.editable(),h=c.codable(),i=c.popover(),k=c.handle(),l=d.data("options"),m=j.html(g,!1);m=n(m,0,!1,["<img","<br","<hr"]),h.val(m);var p=f.find(".btn[data-event=codeview]").height(),q=a(window).height()-p;if(h.height(g.height()),b.invoke("toolbar.updateCodeview",f,!0),b.invoke("popover.hide",i),b.invoke("handle.hide",k),d.addClass("codeview"),h.focus(),e.hasCodeMirror){var r=C.fromTextArea(h[0],l.codemirror);if(l.codemirror.tern){var s=new C.TernServer(l.codemirror.tern);r.ternServer=s,r.on("cursorActivity",function(a){s.updateArgHints(a)})}d.hasClass("fullscreen")?r.setSize(null,q):r.setSize(null,g.outerHeight()),h.data("cmEditor",r)}},this.deactivate=function(a){var c=a.holder(),d=a.editor(),f=a.toolbar(),g=a.editable(),h=a.codable(),i=d.data("options");if(e.hasCodeMirror){var k=h.data("cmEditor");h.val(k.getValue()),k.toTextArea()}var l=j.value(h,i.prettifyHtml)||j.emptyPara,m=g.html()!==l;g.html(l),g.height(i.height?h.height():"auto"),d.removeClass("codeview"),m&&b.bindCustomEvent(c,g.data("callbacks"),"change")(g.html(),g),g.focus(),b.invoke("toolbar.updateCodeview",f,!1)}},E=function(b){var c=a(document);this.attach=function(a,b){b.airMode||b.disableDragAndDrop?c.on("drop",function(a){a.preventDefault()}):this.attachDragAndDropEvent(a,b)},this.attachDragAndDropEvent=function(d,e){var f=a(),g=d.editor(),h=d.dropzone(),i=h.find(".note-dropzone-message");c.on("dragenter",function(a){var c=b.invoke("codeview.isActivated",d),j=g.width()>0&&g.height()>0;c||f.length||!j||(g.addClass("dragover"),h.width(g.width()),h.height(g.height()),i.text(e.langInfo.image.dragImageHere)),f=f.add(a.target)}).on("dragleave",function(a){f=f.not(a.target),f.length||g.removeClass("dragover")}).on("drop",function(){f=a(),g.removeClass("dragover")}),h.on("dragenter",function(){h.addClass("hover"),i.text(e.langInfo.image.dropImage)}).on("dragleave",function(){h.removeClass("hover"),i.text(e.langInfo.image.dragImageHere)}),h.on("drop",function(c){var d=c.originalEvent.dataTransfer,e=j.makeLayoutInfo(c.currentTarget||c.target);if(d&&d.files&&d.files.length)c.preventDefault(),e.editable().focus(),b.insertImages(e,d.files);else for(var f=function(){e.holder().materialnote("insertNode",this)},g=0,h=d.types.length;g<h;g++){var i=d.types[g],k=d.getData(i);i.toLowerCase().indexOf("text")>-1?e.holder().materialnote("pasteHTML",k):a(k).each(f)}}).on("dragover",!1)}},F=function(b){var c;this.attach=function(f){(window.clipboardData||e.isFF)&&(c=a("<div />").attr("contenteditable",!0).css({position:"absolute",left:-1e5,opacity:0}),f.editable().after(c),c.one("paste",d),f.editable().on("keydown",function(a){a.ctrlKey&&86===a.keyCode&&(b.invoke("saveRange",f.editable()),c&&c.focus())})),f.editable().on("paste",d)};var d=function(a){var d=a.originalEvent.clipboardData,e=j.makeLayoutInfo(a.currentTarget||a.target),f=e.editable();if(!d||!d.items||!d.items.length){if(!f.data("callbacks").onImageUpload)return;return void setTimeout(function(){if(c){var a=c[0].firstChild;if(a){if(b.invoke("restoreRange",f),j.isImg(a)){for(var d=a.src,g=atob(d.split(",")[1]),h=new Uint8Array(g.length),i=0;i<g.length;i++)h[i]=g.charCodeAt(i);var k=new Blob([h],{type:"image/png"});k.name="clipboard.png",b.invoke("focus",f),b.insertImages(e,[k])}else b.invoke("pasteHTML",f,c.html());c.remove()}}},0)}var i=g.head(d.items);"file"===i.kind&&-1!==i.type.indexOf("image/")&&b.insertImages(e,[i.getAsFile()]),b.invoke("editor.afterCommand",f)}},G=function(b){var c=function(a,b){a.toggleClass("disabled",!b),a.attr("disabled",!b)},d=function(a,b){a.on("keypress",function(a){a.keyCode===n.code.ENTER&&b.trigger("click")})};this.showLinkDialog=function(b,e,f){return a.Deferred(function(b){var g=e.find(".note-link-dialog"),h=g.find(".note-link-text"),i=h.next("label"),j=g.find(".note-link-url"),k=g.find(".note-link-btn"),l=g.find(".btnClose"),m=g.find("input[type=checkbox]");g.modal("open"),h.val(f.text),f.text.length>0&&i.addClass("active"),h.on("keyup",function(){c(k,h.val()&&j.val()),f.text=h.val()}),l.click(function(a){a.preventDefault(),g.modal("close")}),f.url||(f.url=f.text||"http://",c(k,f.text)),j.on("keyup",function(){c(k,h.val()&&j.val()),f.text||(i.addClass("active"),h.val(j.val()))}).val(f.url).trigger("focus").trigger("select"),d(j,k),d(h,k),m.prop("checked",f.newWindow),k.one("click",function(c){c.preventDefault(),b.resolve({range:f.range,url:j.val(),text:h.val(),newWindow:m.is(":checked")}),a(".note-link-text").val(""),a(".note-link-text").next("label").removeClass("active"),a(".note-link-url").val(""),g.modal("close")})}).promise()},this.show=function(a){var c=a.editor(),d=a.dialog(),e=a.editable(),f=a.popover(),g=b.invoke("editor.getLinkInfo",e),h=c.data("options");b.invoke("editor.saveRange",e),this.showLinkDialog(e,d,g).then(function(a){b.invoke("editor.restoreRange",e),b.invoke("editor.createLink",e,a,h),b.invoke("popover.hide",f)}).fail(function(){b.invoke("editor.restoreRange",e)})}},H=function(b){var c=function(a,b){a.toggleClass("disabled",!b),a.attr("disabled",!b)},d=function(a,b){a.on("keypress",function(a){a.keyCode===n.code.ENTER&&b.trigger("click")})};this.show=function(a){var c=a.dialog(),d=a.editable();b.invoke("editor.saveRange",d),this.showImageDialog(d,c).then(function(c){b.invoke("editor.restoreRange",d),"string"==typeof c?b.invoke("editor.insertImage",d,c):b.insertImages(a,c)}).fail(function(){b.invoke("editor.restoreRange",d)})},this.showImageDialog=function(b,e){return a.Deferred(function(a){var b=e.find(".note-image-dialog"),f=e.find(".note-image-input"),g=e.find(".note-image-url"),h=e.find(".note-image-btn"),i=b.find(".btnClose");b.modal("open"),f.replaceWith(f.clone().on("change",function(){a.resolve(this.files||this.value),g.val(""),b.modal("close"),a.resolve()}).val("")),h.click(function(c){c.preventDefault(),a.resolve(g.val()),g.val(""),b.modal("close"),a.resolve()}),i.click(function(a){a.preventDefault(),b.modal("close")}),g.on("keyup paste",function(a){var b;b="paste"===a.type?a.originalEvent.clipboardData.getData("text"):g.val(),c(h,b)}),d(g,h)})}},I=function(b){this.showHelpDialog=function(b,c){return a.Deferred(function(a){c.find(".note-help-dialog").modal("open"),a.resolve()}).promise()},this.show=function(a){var c=a.dialog(),d=a.editable();b.invoke("editor.saveRange",d,!0),this.showHelpDialog(d,c).then(function(){b.invoke("editor.restoreRange",d)})}},J=function(){var b=this.modules={editor:new u(this),toolbar:new w(this),statusbar:new y(this),popover:new z(this),handle:new A(this),fullscreen:new B(this),codeview:new D(this),dragAndDrop:new E(this),clipboard:new F(this),linkDialog:new G(this),imageDialog:new H(this),helpDialog:new I(this)};this.invoke=function(){var a=g.head(g.from(arguments)),b=g.tail(g.from(arguments)),c=a.split("."),d=c.length>1,e=d&&g.head(c),f=d?g.last(c):g.head(c),h=this.getModule(e),i=h[f];return i&&i.apply(h,b)},this.getModule=function(a){return this.modules[a]||this.modules.editor};var c=this.bindCustomEvent=function(a,b,c){return function(){var d=b[f.namespaceToCamel(c,"on")];return d&&d.apply(a[0],arguments),a.trigger("materialnote."+c,arguments)}};this.insertImages=function(d,e){var f=d.editor(),g=d.editable(),h=d.holder(),i=g.data("callbacks"),j=f.data("options");i.onImageUpload?c(h,i,"image.upload")(e):a.each(e,function(a,d){var e=d.name;j.maximumImageFileSize&&j.maximumImageFileSize<d.size?c(h,i,"image.upload.error")(j.langInfo.image.maximumFileSizeError):m.readFileAsDataURL(d).then(function(a){b.editor.insertImage(g,a,e)}).fail(function(){c(h,i,"image.upload.error")(j.langInfo.image.maximumFileSizeError)})})};var d={showLinkDialog:function(a){b.linkDialog.show(a)},showImageDialog:function(a){b.imageDialog.show(a)},showHelpDialog:function(a){b.helpDialog.show(a)},fullscreen:function(a){b.fullscreen.toggle(a)},codeview:function(a){b.codeview.toggle(a)}},h=function(a){j.isImg(a.target)&&a.preventDefault()},i=function(a){var c=j.makeLayoutInfo(a.currentTarget||a.target);b.editor.removeBogus(c.editable()),k(a)},k=function(a){setTimeout(function(){var c=j.makeLayoutInfo(a.currentTarget||a.target),d=b.editor.currentStyle(a.target);if(d){var e=c.editor().data("options").airMode;e||b.toolbar.update(c.toolbar(),d),b.popover.update(c.popover(),d,e),b.handle.update(c.handle(),d,e)}},0)},l=function(a){var c=j.makeLayoutInfo(a.currentTarget||a.target);b.popover.hide(c.popover()),b.handle.hide(c.handle())},p=function(b){a(b.target).closest("[data-event]").length&&b.preventDefault()},q=function(c){var e=a(c.target).closest("[data-event]");if(e.length){var m,f=e.attr("data-event"),h=e.attr("data-value"),i=e.attr("data-hide"),l=j.makeLayoutInfo(c.target);if(-1!==a.inArray(f,["resize","floatMe","removeMedia","imageShape","imageClass"])){var n=l.handle().find(".note-control-selection");m=a(n.data("target"))}if(i&&e.parents(".popover").hide(),a.isFunction(a.materialnote.pluginEvents[f]))a.materialnote.pluginEvents[f](c,b.editor,l,h);else if(b.editor[f]){var o=l.editable();o.focus(),b.editor[f](o,h,m),c.preventDefault()}else d[f]&&(d[f].call(this,l),c.preventDefault());if(-1!==a.inArray(f,["backColor","foreColor"])){var p=l.editor().data("options",p);(p.airMode?b.popover:b.toolbar).updateRecentColor(g.head(e),f,h)}k(c)}},r=26,s=function(b,c){var n,d=a(b.target.parentNode),e=d.parent(),f=d.next(),g=d.find(".note-dimension-picker-mousecatcher"),h=d.find(".note-dimension-picker-highlighted"),i=d.find(".note-dimension-picker-unhighlighted"),j=e.find("[id$='-hoverable']"),k=e.find("[id$='-bordered']"),l=e.find("[id$='-striped']"),m=e.find("[id$='-responsive']");if(void 0===b.offsetX){var o=a(b.target).offset();n={x:b.pageX-o.left,y:b.pageY-o.top}}else n={x:b.offsetX,y:b.offsetY};var p={c:Math.ceil(n.x/r)||1,r:Math.ceil(n.y/r)||1},q=[];j.is(":checked")&&q.push("hoverable"),k.is(":checked")&&q.push("bordered"),l.is(":checked")&&q.push("striped"),m.is(":checked")&&q.push("responsive-table"),h.css({width:p.c*r+"px",height:p.r*r+"px"}),g.attr("data-value",p.c+"x"+p.r+"x"+q.join("x")),i.css({width:c.insertTableMaxSize*r+"px"}),3<p.r&&p.r<c.insertTableMaxSize.row&&i.css({height:(p.r+1)*r+"px"}),f.html(p.c+" x "+p.r)};this.bindKeyMap=function(c,e){var f=c.editor(),g=c.editable();g.on("keydown",function(h){var i=[];h.metaKey&&i.push("CMD"),h.ctrlKey&&!h.altKey&&i.push("CTRL"),h.shiftKey&&i.push("SHIFT");var j=n.nameFromCode[h.keyCode];j&&i.push(j);var k,l=i.join("+"),m=e[l];if(m){if(k=a.materialnote.pluginEvents[l],a.isFunction(k)&&k(h,b.editor,c))return!1;k=a.materialnote.pluginEvents[m],a.isFunction(k)?k(h,b.editor,c):b.editor[m]?(b.editor[m](g,f.data("options")),h.preventDefault()):d[m]&&(d[m].call(this,c),h.preventDefault())}else n.isEdit(h.keyCode)&&b.editor.afterCommand(g)})},this.attach=function(a,c){c.shortcuts&&this.bindKeyMap(a,c.keyMap[e.isMac?"mac":"pc"]),a.editable().on("mousedown",h),a.editable().on("keyup mouseup",i),a.editable().on("scroll",l),b.clipboard.attach(a,c),b.handle.attach(a,c),a.popover().on("click",q),a.popover().on("mousedown",p),b.dragAndDrop.attach(a,c),c.airMode||(a.toolbar().on("click",q),a.toolbar().on("mousedown",p),b.statusbar.attach(a,c)),(c.airMode?a.popover():a.toolbar()).find(".note-dimension-picker-mousecatcher").css({width:c.insertTableMaxSize.col*r+"px",height:c.insertTableMaxSize.row*r+"px"}).on("mousemove",function(a){s(a,c)}),a.editor().data("options",c),e.isMSIE||setTimeout(function(){document.execCommand("styleWithCSS",0,c.styleWithSpan)},0);var k=new o(a.editable());a.editable().data("NoteHistory",k),a.editable().data("callbacks",{onInit:c.onInit,onFocus:c.onFocus,onBlur:c.onBlur,onKeydown:c.onKeydown,onKeyup:c.onKeyup,onMousedown:c.onMousedown,onEnter:c.onEnter,onPaste:c.onPaste,onBeforeCommand:c.onBeforeCommand,onChange:c.onChange,onImageUpload:c.onImageUpload,onImageUploadError:c.onImageUploadError,onMediaDelete:c.onMediaDelete,onToolbarClick:c.onToolbarClick}),j.isTextarea(g.head(a.holder()))&&a.holder().closest("form").submit(function(){a.holder().val(a.holder().code())})},this.attachCustomEvent=function(b,d){var f=b.holder(),h=b.editable(),i=h.data("callbacks");h.focus(c(f,i,"focus")),h.blur(c(f,i,"blur")),h.keydown(function(a){a.keyCode===n.code.ENTER&&c(f,i,"enter").call(this,a),c(f,i,"keydown").call(this,a)}),h.keyup(c(f,i,"keyup")),h.on("mousedown",c(f,i,"mousedown")),h.on("mouseup",c(f,i,"mouseup")),h.on("scroll",c(f,i,"scroll")),h.on("paste",c(f,i,"paste"));var k=e.isMSIE?"DOMCharacterDataModified DOMSubtreeModified DOMNodeInserted":"input";h.on(k,function(){c(f,i,"change")(h.html(),h)}),d.airMode||(b.toolbar().click(c(f,i,"toolbar.click")),b.popover().click(c(f,i,"popover.click"))),j.isTextarea(g.head(f))&&f.closest("form").submit(function(a){c(f,i,"submit").call(this,a,f.code())}),a(".modal").modal({dismissible:!0}),c(f,i,"init")(b);for(var l=0,m=a.materialnote.plugins.length;l<m;l++)a.isFunction(a.materialnote.plugins[l].init)&&a.materialnote.plugins[l].init(b)},this.detach=function(a,b){a.holder().off(),a.editable().off(),a.popover().off(),a.handle().off(),a.dialog().off(),b.airMode||(a.dropzone().off(),a.toolbar().off(),a.statusbar().off())}},K=function(){var b=function(a,b){var c=b.event,d=b.value,e=b.title,f=b.style,g=b.btnClassName,h=b.className,i=b.dropdown,j=b.hide;if(i){return['<div class="btn-group',(h?" "+h:"")+'">','<button class="waves-effect waves-light btn dropdown '+(g||"")+'"',e?' title="'+e+'"':"",c?' data-event="'+c+'"':"",d?" data-value='"+d+"'":"",j?" data-hide='"+j+"'":"",'><i class="material-icons left">arrow_drop_down</i>'+a+"</button>",i,"</div>"].join("")}return['<div class="waves-effect waves-light btn',(h?" "+h:"")+'"',e?' title="'+e+'"':"",f?' style="'+f+'"':"",c?' data-event="'+c+'"':"",d?" data-value='"+d+"'":"",j?" data-hide='"+j+"'":"",' tabindex="-1">'+a+"</div>"].join("")},c=function(a,c){return b('<i class="material-icons">'+a+"</i>",c)},d=function(b,c){var d=a('<div class="'+b+' popover bottom in" style="display: none;"><div class="arrow"></div><div class="popover-content"></div></div>');return d.find(".popover-content").append(c),d},g=function(a,b,c,d){return['<div class="'+a+' modal">','<div class="modal-content">',b?"<h4>"+b+"</h4>":"","<p>"+c+"</p>","</div>",d?'<div class="modal-footer">'+d+"</div>":"","</div>"].join("")},h={picture:function(a,b){return c(b.iconPrefix+b.icons.image.image,{event:"showImageDialog",title:a.image.image,hide:!0})},link:function(a,b){return c(b.iconPrefix+b.icons.link.link,{event:"showLinkDialog",title:a.link.link,hide:!0})},table:function(a,b){var d='<ul class="note-table dropdown-menu"><div class="row"><div class="col s6 preventDropClose"><input type="checkbox" id="'+materialUniqueId+'-bordered" checked="checked" /><label for="'+materialUniqueId+'-bordered">'+a.table.bordered+'</label></div><div class="col s6 preventDropClose"><input type="checkbox" id="'+materialUniqueId+'-striped" checked="checked" /><label for="'+materialUniqueId+'-striped">'+a.table.striped+'</label></div></div><div class="row"><div class="col s6 preventDropClose"><input type="checkbox" id="'+materialUniqueId+'-hoverable" checked="checked" /><label for="'+materialUniqueId+'-hoverable">'+a.table.hoverable+'</label></div><div class="col s6 preventDropClose"><input type="checkbox" id="'+materialUniqueId+'-responsive" checked="checked" /><label for="'+materialUniqueId+'-responsive">'+a.table.responsive+'</label></div></div><div class="note-dimension-picker"><div class="note-dimension-picker-mousecatcher" data-event="insertTable" data-value="1x1"></div><div class="note-dimension-picker-highlighted"></div><div class="note-dimension-picker-unhighlighted"></div></div><div class="note-dimension-display"> 1 x 1 </div></ul>';return c(b.iconPrefix+b.icons.table.table,{title:a.table.table,dropdown:d})},style:function(a,b){var d=b.styleTags.reduce(function(b,c){var d=a.style["p"===c?"normal":c];return b+'<li><div data-event="formatBlock" data-value="'+c+'">'+("p"===c||"pre"===c?d:"<"+c+">"+d+"</"+c+">")+"</div></li>"},"");return c(b.iconPrefix+b.icons.style.style,{title:a.style.style,dropdown:'<ul class="dropdown-menu largeDropdown">'+d+"</ul>"})},fontname:function(a,c){var d=[],f=c.fontNames.reduce(function(a,b){return e.isFontInstalled(b)||-1!==c.fontNamesIgnoreCheck.indexOf(b)?(d.push(b),a+'<li><div data-event="fontName" href="#" data-value="'+b+'" style="font-family:\''+b+'\'"><i class="material-icons tiny transparent">'+c.iconPrefix+c.icons.misc.check+"</i> "+b+"</div></li>"):a},""),g=e.isFontInstalled(c.defaultFontName),h=g?c.defaultFontName:d[0];return b('<div class="note-current-fontname">'+h+"</div>",{title:a.font.name,className:"note-fontname",dropdown:'<ul class="dropdown-menu note-check">'+f+"</ul>"})},fontsize:function(a,c){var d=c.fontSizes.reduce(function(a,b){return a+'<li><div data-event="fontSize" href="#" data-value="'+b+'"><i class="material-icons tiny transparent">'+c.iconPrefix+c.icons.misc.check+"</i> "+b+"</div></li>"},"");return b('<span class="note-current-fontsize">15</span>',{title:a.font.size,className:"note-fontsize",dropdown:'<ul class="dropdown-menu note-check">'+d+"</ul>"})},color:function(a,c){var d='<i class="material-icons">'+c.icons.color.recent+"</i>",e=b(d,{className:"note-recent-color",title:a.color.recent,style:"color: "+c.defaultTextColor+"; background-color: "+c.defaultBackColor+";",event:"color",value:'{"backColor": "'+c.defaultBackColor+'"}'}),f='<ul id="colors" class="dropdown-menu"><li><div class="col s12"><ul class="tabs"><li class="tab"><a href="#'+materialUniqueId+'-foreColor" class="active">'+a.color.foreground+'</a></li><li class="tab"><a href="#'+materialUniqueId+'-backColor">'+a.color.background+'</a></li></ul></div><div class="col s12 colorTable"><div id="'+materialUniqueId+'-foreColor"><div class="note-color-reset waves-effect waves-light btn" data-event="foreColor" data-value="'+c.defaultTextColor+'" title="'+a.color.reset+'">'+a.color.resetToDefault+'</div><div class="colorName"></div><div class="note-color-palette" data-target-event="foreColor"></div></div><div id="'+materialUniqueId+'-backColor"><div class="note-color-reset waves-effect waves-light btn" data-event="backColor" data-value="'+c.defaultBackColor+'" title="'+a.color.transparent+'">'+a.color.setTransparent+'</div><div class="colorName"></div><div class="note-color-palette" data-target-event="backColor"></div></div></div></li></ul>';return b("",{title:a.color.more,className:"closeLeft",dropdown:f})+e},bold:function(a,b){return c(b.iconPrefix+b.icons.font.bold,{event:"bold",title:a.font.bold})},italic:function(a,b){return c(b.iconPrefix+b.icons.font.italic,{event:"italic",title:a.font.italic})},underline:function(a,b){return c(b.iconPrefix+b.icons.font.underline,{event:"underline",title:a.font.underline})},strikethrough:function(a,b){return c(b.iconPrefix+b.icons.font.strikethrough,{event:"strikethrough",title:a.font.strikethrough})},superscript:function(a,b){return c(b.iconPrefix+b.icons.font.superscript,{event:"superscript",title:a.font.superscript})},subscript:function(a,b){return c(b.iconPrefix+b.icons.font.subscript,{event:"subscript",title:a.font.subscript})},clear:function(a,b){return c(b.iconPrefix+b.icons.font.clear,{event:"removeFormat",title:a.font.clear})},ul:function(a,b){return c(b.iconPrefix+b.icons.lists.unordered,{event:"insertUnorderedList",title:a.lists.unordered})},ol:function(a,b){return c(b.iconPrefix+b.icons.lists.ordered,{event:"insertOrderedList",title:a.lists.ordered})},leftButton:function(a,b){return c(b.iconPrefix+b.icons.paragraph.left,{title:a.paragraph.left,event:"justifyLeft"})},centerButton:function(a,b){return c(b.iconPrefix+b.icons.paragraph.center,{title:a.paragraph.center,event:"justifyCenter"})},rightButton:function(a,b){return c(b.iconPrefix+b.icons.paragraph.right,{title:a.paragraph.right,event:"justifyRight"})},justifyButton:function(a,b){return c(b.iconPrefix+b.icons.paragraph.justify,{title:a.paragraph.justify,event:"justifyFull"})},outdentButton:function(a,b){return c(b.iconPrefix+b.icons.paragraph.outdent,{title:a.paragraph.outdent,event:"outdent"})},indentButton:function(a,b){return c(b.iconPrefix+b.icons.paragraph.indent,{title:a.paragraph.indent,event:"indent"})},paragraph:function(a,b){var d=c(b.iconPrefix+b.icons.paragraph.left,{title:a.paragraph.left,event:"justifyLeft"}),e=c(b.iconPrefix+b.icons.paragraph.center,{title:a.paragraph.center,event:"justifyCenter"}),f=c(b.iconPrefix+b.icons.paragraph.right,{title:a.paragraph.right,event:"justifyRight"}),g=c(b.iconPrefix+b.icons.paragraph.justify,{title:a.paragraph.justify,event:"justifyFull"}),h=c(b.iconPrefix+b.icons.paragraph.outdent,{title:a.paragraph.outdent,event:"outdent"}),i=c(b.iconPrefix+b.icons.paragraph.indent,{title:a.paragraph.indent,event:"indent"}),j='<ul class="dropdown-menu"><div class="note-align btn-group">'+d+e+f+g+'</div><div class="note-list btn-group">'+i+h+"</div></ul>";return c(b.iconPrefix+b.icons.paragraph.paragraph,{title:a.paragraph.paragraph,dropdown:j})},lineheight:function(a,b){var d=b.lineHeights.reduce(function(a,c){return a+'<li><div data-event="lineHeight" href="#" data-value="'+parseFloat(c)+'"><i class="material-icons tiny transparent">'+b.iconPrefix+b.icons.misc.check+"</i> "+c+"</div></li>"},"");return c(b.iconPrefix+b.icons.font.height,{title:a.font.height,className:"note-height",dropdown:'<ul class="dropdown-menu note-check">'+d+"</ul>"})},help:function(a,b){return c(b.iconPrefix+b.icons.options.help,{event:"showHelpDialog",title:a.options.help,hide:!0})},fullscreen:function(a,b){return c(b.iconPrefix+b.icons.options.fullscreen,{event:"fullscreen",title:a.options.fullscreen})},codeview:function(a,b){return c(b.iconPrefix+b.icons.options.codeview,{event:"codeview",title:a.options.codeview})},undo:function(a,b){return c(b.iconPrefix+b.icons.history.undo,{event:"undo",title:a.history.undo})},redo:function(a,b){return c(b.iconPrefix+b.icons.history.redo,{event:"redo",title:a.history.redo})},hr:function(a,b){return c(b.iconPrefix+b.icons.hr.insert,{event:"insertHorizontalRule",title:a.hr.insert})}},i=function(e,f){var g=function(){var a=c(f.iconPrefix+f.icons.link.edit,{title:e.link.edit,event:"showLinkDialog",hide:!0}),b=c(f.iconPrefix+f.icons.link.unlink,{title:e.link.unlink,event:"unlink"});return d("note-link-popover",'<a href="http://www.google.com" target="_blank">www.google.com</a>&nbsp;&nbsp;<div class="note-insert btn-group">'+a+b+"</div>")},i=function(){var i=(b('<span class="note-fontsize-10">100%</span>',{title:e.image.resizeFull,event:"resize",value:"1"}),b('<span class="note-fontsize-10">50%</span>',{title:e.image.resizeHalf,event:"resize",value:"0.5"}),b('<span class="note-fontsize-10">25%</span>',{title:e.image.resizeQuarter,event:"resize",value:"0.25"}),c(f.iconPrefix+f.icons.image.floatLeft,{title:e.image.floatLeft,event:"floatMe",value:"left"})),j=c(f.iconPrefix+f.icons.image.floatRight,{title:e.image.floatRight,event:"floatMe",value:"right"}),k=c(f.iconPrefix+f.icons.image.floatNone,{title:e.image.floatNone,event:"floatMe",value:"none"}),l=c(f.iconPrefix+f.icons.image.shapeRounded,{title:e.image.shapeRounded,event:"imageClass",value:"img-rounded"}),m=c(f.iconPrefix+f.icons.image.shapeCircle,{title:e.image.shapeCircle,event:"imageClass",value:"img-circle"}),n=c(f.iconPrefix+f.icons.image.shapeThumbnail,{title:e.image.shapeThumbnail,event:"imageClass",value:"img-thumbnail"}),o=c(f.iconPrefix+f.icons.image.bordered,{title:e.image.bordered,event:"imageClass",value:"img-bordered"}),p=c(f.iconPrefix+f.icons.image.shapeNone,{title:e.image.shapeNone,event:"imageShape",value:""}),q=c(f.iconPrefix+f.icons.image.remove,{title:e.image.remove,event:"removeMedia",value:"none"});return d("note-image-popover",'<div class="btn-group">'+i+j+k+'</div><div class="btn-group">'+l+m+n+o+p+'</div><div class="btn-group">'+q+"</div>")},j=function(){for(var b=a("<div />"),c=0,g=f.airPopover.length;c<g;c++){for(var i=f.airPopover[c],j=a('<div class="note-'+i[0]+' btn-group">'),k=0,l=i[1].length;k<l;k++){var m=a(h[i[1][k]](e,f));m.attr("data-name",i[1][k]),j.append(m)}b.append(j)}return d("note-air-popover",b.children())},k=a('<div class="note-popover" />');return k.append(g()),k.append(i()),f.airMode&&k.append(j()),k},k=function(){return'<div class="note-handle"><div class="note-control-selection"><div class="note-control-selection-bg"></div><div class="note-control-sizing note-control-se"></div><div class="note-control-selection-info"></div></div></div>'},l=function(a,b){var d=[];for(var e in b)b.hasOwnProperty(e)&&d.push("<tr><td>"+b[e].kbd+"</td><td>"+b[e].text+"</td></tr>");return"<thead><tr><th>"+a+"</th><th>(keys)</th></tr></thead><tbody>"+d.join("")+"</tbody>"},m=function(a){var b=[{kbd:" + B",text:a.font.bold},{kbd:" + I",text:a.font.italic},{kbd:" + U",text:a.font.underline},{kbd:" + \\",text:a.font.clear}];return l(a.shortcut.textFormatting,b)},n=function(a){var b=[{kbd:" + Z",text:a.history.undo},{kbd:" +  + Z",text:a.history.redo},{kbd:" + ]",text:a.paragraph.indent},{kbd:" + [",text:a.paragraph.outdent},{kbd:" + ENTER",text:a.hr.insert}];return l(a.shortcut.action,b)},o=function(a){var b=[{kbd:" +  + L",text:a.paragraph.left},{kbd:" +  + E",text:a.paragraph.center},{kbd:" +  + R",text:a.paragraph.right},{kbd:" +  + J",text:a.paragraph.justify},{kbd:" +  + NUM7",text:a.lists.ordered},{kbd:" +  + NUM8",text:a.lists.unordered}];return l(a.shortcut.paragraphFormatting,b)},p=function(a){var b=[{kbd:" + NUM0",text:a.style.normal},{kbd:" + NUM1",text:a.style.h1},{kbd:" + NUM2",text:a.style.h2},{kbd:" + NUM3",text:a.style.h3},{kbd:" + NUM4",text:a.style.h4},{kbd:" + NUM5",text:a.style.h5},{kbd:" + NUM6",text:a.style.h6}];return l(a.shortcut.documentStyle,b)},r=function(a,b){var c=['<table class="striped hoverable">'+n(a,b)+"</table>",'<table class="striped hoverable">'+p(a,b)+"</table>",'<table class="striped hoverable">'+m(a,b)+"</table>",'<table class="striped hoverable">'+o(a,b)+"</table>"].join("<br>");return b.extraKeys,c},s=function(a){return a.replace(//g,"Ctrl").replace(//g,"Shift")},t={image:function(a,b){if(b.maximumImageFileSize){var d=Math.floor(Math.log(b.maximumImageFileSize)/Math.log(1024)),e=1*(b.maximumImageFileSize/Math.pow(1024,d)).toFixed(2)+" "+" KMGTP"[d]+"B";"<small>"+a.image.maximumFileSize+" : "+e+"</small>"}var f='<div class="row"><div class="col s12"><div class="file-field input-field"><div class="btn"><span>'+a.image.image+'</span><input class="note-image-input" name="files" type="file" /></div><div class="file-path-wrapper"><input class="file-path" type="text" /></div></div></div></div><div class="row"><div class="input-field col s12"><input class="note-image-url" type="text" /><label>'+a.image.url+"</label></div></div>",h='<button href="#" class="waves-effect waves-light btn note-image-btn disabled" disabled>'+a.image.insert+'</button><button class="waves-effect waves-light btn btnClose">'+a.shortcut.close+"</button>";return g("note-image-dialog",a.image.insert,f,h)},link:function(a,b){var c='<div class="row"><div class="input-field col s12"><input class="note-link-text" type="text" /><label>'+a.link.textToDisplay+'</label></div></div><div class="row"><div class="input-field col s12"><input class="note-link-url" type="text" value="http://" /><label class="active">'+a.link.url+"</label></div></div>"+(b.disableLinkTarget?"":'<div class="row"><div class="col s12"><input type="checkbox" id="'+materialUniqueId+'-noteInsertLinkNewWindow" checked="checked" /><label for="'+materialUniqueId+'-noteInsertLinkNewWindow">'+a.link.openInNewWindow+"</label></div></div>"),d='<button href="#" class="waves-effect waves-light btn note-link-btn disabled" disabled>'+a.link.insert+'</button><button class="waves-effect waves-light btn btnClose">'+a.shortcut.close+"</button>";return g("note-link-dialog",a.link.insert,c,d)},help:function(a,b){var c=e.isMac?r(a,b):s(r(a,b)),d='<button href="#" class="waves-effect waves-light btn modal-close">'+a.shortcut.close+"</button>";return g("note-help-dialog",a.shortcut.shortcuts,c,d)}},u=function(b,c){var d="";return a.each(t,function(a,e){d+=e(b,c)}),'<div class="note-dialog">'+d+"</div>"},v=function(){return'<div class="note-resizebar"><div class="note-icon-bar"></div><div class="note-icon-bar"></div><div class="note-icon-bar"></div></div>'},w=function(a){return e.isMac&&(a=a.replace("CMD","").replace("SHIFT","")),a.replace("BACKSLASH","\\").replace("SLASH","/").replace("LEFTBRACKET","[").replace("RIGHTBRACKET","]")},x=function(b,c,d){a(document).ready(function(){var d=f.invertObject(c),e=b.find(".btn");console.log(b),e.each(function(b,c){var e=a(c),f=d[e.data("event")],g=e.attr("title");f&&e.attr("data-tooltip",function(b,c){return g=g+" ("+w(f)+")",a(this).removeAttr("title"),g}),e.attr("data-position","bottom"),e.attr("data-tooltip",g),e.removeAttr("title")}).tooltip({container:b,position:"top",delay:30})})},y=function(b,c){var d=c.colors,e=c.colorTitles;b.find(".note-color-palette").each(function(){for(var b=a(this),c=b.attr("data-target-event"),f=[],g=0,h=d.length;g<h;g++){for(var i=d[g],j=e[g],k=[],l=0,m=i.length;l<m;l++){var n=i[l],o=j[l];k.push(['<button type="button" class="note-color-btn" style="background-color:',n,';" data-event="',c,'" data-value="',n,'" data-description="',o,'" data-toggle="button" tabindex="-1"></button>'].join(""))}f.push('<div class="note-color-row">'+k.join("")+"</div>")}b.html(f.join("")),b.find("button").mouseenter(function(){b.siblings(".colorName").html(a(this).data("description"))}),b.mouseleave(function(){a(this).siblings(".colorName").html("")})})};this.createLayoutByAirMode=function(b,c){var d=c.langInfo,g=c.keyMap[e.isMac?"mac":"pc"],h=f.uniqueId();b.addClass("note-air-editor note-editable"),b.attr({id:"note-editor-"+h,contentEditable:!0});var j=document.body,l=a(i(d,c));l.addClass("note-air-layout"),l.attr("id","note-popover-"+h),l.appendTo(j),x(l,g),y(l,c);var m=a(k());m.addClass("note-air-layout"),m.attr("id","note-handle-"+h),m.appendTo(j);var n=a(u(d,c));n.addClass("note-air-layout"),n.attr("id","note-dialog-"+h),n.find("button.close, a.modal-close").click(function(){a(this).closest(".modal").modal("close")}),n.appendTo(j)},this.createLayoutByFrame=function(b,c){function C(){a(window).scroll(function(){if(f.hasClass("fullscreen"))return console.log("fullscreen"),!1;var j,k,l,m,n,o,p,q,r,d=f.children(".note-toolbar"),g=(d.outerHeight(),f.children(".note-editable")),h=g.outerHeight();f.width;r=a("."+c.otherStaticBarClass).outerHeight(),r||(r=0),p=a(document).scrollTop(),j=d.offset().top,k=f.offset().top,l=k+h,m=j-r,o=l-r,n=k-r,p>m&&p<o?(q=p-f.offset().top+r,d.css({top:q+"px","z-index":2e3})):p<j&&p<o&&(d.css({top:0,"z-index":1052}),p>n&&(q=p-f.offset().top+r,d.css({top:q+"px","z-index":2e3})))})}var d=c.langInfo,f=a('<div class="note-editor"></div>');c.width&&f.width(c.width),c.height>0&&a('<div class="note-statusbar">'+(c.disableResizeEditor?"":v())+"</div>").prependTo(f);var g=!b.is(":disabled"),l=a('<div class="note-editable" contentEditable="'+g+'"></div>').prependTo(f);c.height&&l.height(c.height),c.direction&&l.attr("dir",c.direction);var m=b.attr("placeholder")||c.placeholder;m&&l.attr("data-placeholder",m),l.html(j.html(b)),a('<textarea class="note-codable"></textarea>').prependTo(f);for(var n=a('<div class="note-toolbar btn-toolbar" />'),o=0,p=c.toolbar.length;o<p;o++){for(var q=c.toolbar[o][0],r=c.toolbar[o][1],s=a('<div class="note-'+q+' btn-group" />'),t=0,w=r.length;t<w;t++){var z=h[r[t]];if(a.isFunction(z)){var A=a(z(d,c));A.attr("data-name",r[t]),s.append(A)}}n.append(s)}n.prependTo(f);var B=c.keyMap[e.isMac?"mac":"pc"];y(n,c),x(n,B,"bottom"),c.followingToolbar&&C();var D=a(i(d,c)).prependTo(f);y(D,c),x(D,B),a(k()).prependTo(f),a(u(d,c)).prependTo(f).find("button.close, a.modal-close").click(function(){a(this).closest(".modal").modal("close")}),a('<div class="note-dropzone"><div class="note-dropzone-message"></div></div>').prependTo(f),f.insertAfter(b),b.hide()},this.hasNoteEditor=function(a){return this.noteEditorFromHolder(a).length>0},this.noteEditorFromHolder=function(b){return b.hasClass("note-air-editor")?b:b.next().hasClass("note-editor")?b.next():a()},this.createLayout=function(a,b){b.airMode?this.createLayoutByAirMode(a,b):this.createLayoutByFrame(a,b)},this.layoutInfoFromHolder=function(a){var b=this.noteEditorFromHolder(a);if(b.length)return b.data("holder",a),j.buildLayoutInfo(b)},this.removeLayout=function(a,b,c){c.airMode?(a.removeClass("note-air-editor note-editable").removeAttr("id contentEditable"),b.popover().remove(),b.handle().remove(),b.dialog().remove()):(a.html(b.editable().html()),b.editor().remove(),a.show())},this.getTemplate=function(){return{button:b,iconButton:c,dialog:g}},this.addButtonInfo=function(a,b){h[a]=b},this.addDialogInfo=function(a,b){t[a]=b}};a.materialnote=a.materialnote||{},a.extend(a.materialnote,l);var L=new K,M=new J;a.extend(a.materialnote,{renderer:L,eventHandler:M,core:{agent:e,list:g,dom:j,range:k},pluginEvents:{},plugins:[]}),a.materialnote.addPlugin=function(b){a.materialnote.plugins.push(b),b.buttons&&a.each(b.buttons,function(a,b){L.addButtonInfo(a,b)}),b.dialogs&&a.each(b.dialogs,function(a,b){L.addDialogInfo(a,b)}),b.events&&a.each(b.events,function(b,c){a.materialnote.pluginEvents[b]=c}),b.langs&&a.each(b.langs,function(b,c){a.materialnote.lang[b]&&a.extend(a.materialnote.lang[b],c)}),b.options&&a.extend(a.materialnote.options,b.options)},a.fn.extend({materialnote:function(){var b=a.type(g.head(arguments)),c="string"===b,d="object"===b,e=d?g.head(arguments):{};if(e=a.extend({},a.materialnote.options,e),e.icons=a.extend({},a.materialnote.options.icons,e.icons),e.langInfo=a.extend(!0,{},a.materialnote.lang["en-US"],a.materialnote.lang[e.lang]),!c&&d)for(var f=0,h=a.materialnote.plugins.length;f<h;f++){var i=a.materialnote.plugins[f];e.plugin[i.name]&&(a.materialnote.plugins[f]=a.extend(!0,i,e.plugin[i.name]))}this.each(function(b,c){materialUniqueId=a(c).attr("id");var d=a(c);if(!L.hasNoteEditor(d)){L.createLayout(d,e);var f=L.layoutInfoFromHolder(d);d.data("layoutInfo",f),M.attach(f,e),M.attachCustomEvent(f,e)}});var j=this.first();if(j.length){var k=L.layoutInfoFromHolder(j);if(c){var l=g.head(g.from(arguments)),m=g.tail(g.from(arguments)),n=[l,k.editable()].concat(m);return M.invoke.apply(M,n)}e.focus&&k.editable().focus()}return a(this).each(function(b,c){function j(b,e){var h=a(b).next("ul.dropdown-menu");a(b).parent(".btn-group");h.slideUp(0),a(".preventDropClose").click(function(a){a.stopPropagation()}),a(b).click(function(d){var i=Math.round(a(b).parent(".btn-group").offset().left-f.offset().left),j=parseInt(h.css("border-left-width")),k=c.outerWidth(),l=j;h.css({"max-width":k+"px"});var m=h.outerWidth(),n=m+i;n>=k&&(l=n-k,g||(l+=j)),h.css({left:"-"+l+"px"});var o=!0;h.is(":visible")&&(o=!1),e.find("ul.dropdown-menu").slideUp(200),o&&h.slideToggle(200),d.stopPropagation()}),d.unbind().click(function(a){i=!1})}var d,e,f,g=!1;if(a(c).hasClass("note-air-editor")){var h=a(this).attr("id");h&&(h=h.substring(h.lastIndexOf("-")+1,h.length)),c=a("#note-popover-"+h).find(".note-air-popover"),e=c.find("ul.tabs"),d=c.find("li.tab a"),f=a(c).find(".popover-content button.dropdown"),g=!0}else c=a(c).next(".note-editor"),e=c.find("ul.tabs"),d=c.find("li.tab a"),f=a(c).find(".note-toolbar button.dropdown");var i=!0;a(window).click(function(a){i&&c.find("ul.dropdown-menu").slideUp(200),i=!0,a.stopPropagation()}),f.each(function(a,b){j(b,c)}),e.tabs()}),this},code:function(b){if(void 0===b){var c=this.first();if(!c.length)return;var d=L.layoutInfoFromHolder(c),e=d&&d.editable();if(e&&e.length){var f=M.invoke("codeview.isActivated",d);return M.invoke("codeview.sync",d),f?d.codable().val():d.editable().html()}return j.value(c)}return this.each(function(c,d){var e=L.layoutInfoFromHolder(a(d)),f=e&&e.editable();f&&f.html(b)}),this},destroy:function(){return this.each(function(b,c){var d=a(c);if(L.hasNoteEditor(d)){var e=L.layoutInfoFromHolder(d),f=e.editor().data("options");M.detach(e,f),L.removeLayout(d,e,f)}}),this}})});
